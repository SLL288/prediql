{
  "report_timestamp": "2025-10-05T02:40:34.001140",
  "api_url": "https://graphqlzero.almansi.me/api",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.4,
    "simple_detections": 4,
    "llm_detections": 6,
    "consensus_breakdown": {
      "both_detected": 4,
      "llm_only": 2,
      "no_vulnerabilities": 4
    },
    "detection_ratio": 1.5,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 4,
      "llm_potential_detections": 1,
      "potential_consensus_breakdown": {
        "simple_potential_only": 4,
        "no_potential": 5,
        "llm_potential_only": 1
      },
      "potential_detection_ratio": 0.25
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-05T02:40:17.464441",
      "node_name": "createUser_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "createUser": {
            "id": "11",
            "name": "Robert'); DROP TABLE Users; --",
            "email": "robert@example.com"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "SQL Injection (SQLi) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SQL injection vulnerability detected - malicious SQL patterns found in response",
            "evidence": "Response status: 200, SQL patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: SQL Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response indicates that the provided input for the 'name' field, which included a SQL injection payload, was successfully processed and reflected in the 'name' field of the 'createUser' mutation's return value. The presence of `'); DROP TABLE Users; --` strongly suggests that the backend SQL query is vulnerable to injection. If this payload was indeed executed by the underlying database, it would result in the deletion of the 'Users' table, demonstrating a critical SQL Injection vulnerability. Even if the 'DROP TABLE' command itself failed (e.g., due to insufficient permissions or transaction limitations), the fact that the backend processed and reflected such a malicious string indicates poor input sanitization and a high likelihood of successful injection through other means (e.g., data exfiltration or authentication bypass). This is a severe vulnerability as it allows for arbitrary SQL command execution.",
            "evidence": "The 'name' field in the response body contains the string \"Robert'); DROP TABLE Users; --\". This string is a classic SQL injection payload designed to terminate the current SQL query, execute a 'DROP TABLE' command, and then comment out the rest of the original query.",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "SQL Injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "The 'name' field in the response body contains the string \"Robert'); DROP TABLE Users; --\". This string is a classic SQL injection payload designed to terminate the current SQL query, execute a 'DROP TABLE' command, and then comment out the rest of the original query.",
              "explanation": "The GraphQL response indicates that the provided input for the 'name' field, which included a SQL injection payload, was successfully processed and reflected in the 'name' field of the 'createUser' mutation's return value. The presence of `'); DROP TABLE Users; --` strongly suggests that the backend SQL query is vulnerable to injection. If this payload was indeed executed by the underlying database, it would result in the deletion of the 'Users' table, demonstrating a critical SQL Injection vulnerability. Even if the 'DROP TABLE' command itself failed (e.g., due to insufficient permissions or transaction limitations), the fact that the backend processed and reflected such a malicious string indicates poor input sanitization and a high likelihood of successful injection through other means (e.g., data exfiltration or authentication bypass). This is a severe vulnerability as it allows for arbitrary SQL command execution."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T02:40:19.057089",
      "node_name": "createUser_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "createUser": {
            "id": "11",
            "name": "<script>alert('XSS by username')</script>",
            "email": "xss@example.com"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Cross-Site Scripting (XSS) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "XSS injection vulnerability detected - malicious script patterns found in response",
            "evidence": "Response status: 200, XSS patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'name' field in the GraphQL response contains an unescaped '<script>alert('XSS by username')</script>' tag. If this response is rendered directly in a web browser without proper sanitization or encoding, it will execute the embedded JavaScript, leading to a Cross-Site Scripting (XSS) vulnerability. This allows an attacker to inject arbitrary client-side scripts, potentially stealing cookies, defacing the website, or redirecting users.",
            "evidence": "'name': \"<script>alert('XSS by username')</script>\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "'name': \"<script>alert('XSS by username')</script>\"",
              "explanation": "The 'name' field in the GraphQL response contains an unescaped '<script>alert('XSS by username')</script>' tag. If this response is rendered directly in a web browser without proper sanitization or encoding, it will execute the embedded JavaScript, leading to a Cross-Site Scripting (XSS) vulnerability. This allows an attacker to inject arbitrary client-side scripts, potentially stealing cookies, defacing the website, or redirecting users."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T02:40:20.741614",
      "node_name": "createUser_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "createUser": {
            "id": "11",
            "name": "Server Side",
            "website": "http://169.254.169.254/latest/meta-data/"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Server-Side Request Forgery (SSRF) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SSRF injection vulnerability detected - internal network access patterns found",
            "evidence": "Response status: 200, SSRF keywords detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: ssrf_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'website' field in the 'createUser' mutation response contains an internal IP address '169.254.169.254', which is commonly used for AWS EC2 instance metadata. This strongly indicates that the server processed a request to an internal resource based on user-supplied input, a hallmark of Server-Side Request Forgery (SSRF). If the application is vulnerable to SSRF, an attacker could potentially retrieve sensitive instance metadata, access internal services, or perform port scanning on the internal network by manipulating the input to the 'website' field.",
            "evidence": "website: \"http://169.254.169.254/latest/meta-data/\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "ssrf_injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "website: \"http://169.254.169.254/latest/meta-data/\"",
              "explanation": "The 'website' field in the 'createUser' mutation response contains an internal IP address '169.254.169.254', which is commonly used for AWS EC2 instance metadata. This strongly indicates that the server processed a request to an internal resource based on user-supplied input, a hallmark of Server-Side Request Forgery (SSRF). If the application is vulnerable to SSRF, an attacker could potentially retrieve sensitive instance metadata, access internal services, or perform port scanning on the internal network by manipulating the input to the 'website' field."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T02:40:22.461726",
      "node_name": "createUser_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "createUser": {
            "id": "11",
            "name": "Command Injector",
            "address": {
              "street": "Cmd Alley; ls -la /;"
            }
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: OS Command Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The presence of 'Cmd Alley; ls -la /;' in the `address.street` field is a strong indicator of an attempted OS Command Injection. The semicolon (`;`) is a common command separator in many operating systems, allowing an attacker to append additional arbitrary commands. If the backend system processes this street address in a context where it is directly used within a shell command (e.g., for logging, file creation, or an external system call), the `ls -la /` command would be executed on the server. This allows an attacker to execute arbitrary commands, leading to system compromise, data exfiltration, or denial of service.",
            "evidence": "Observed `address.street` field containing 'Cmd Alley; ls -la /;'",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "OS Command Injection",
              "severity": "CRITICAL",
              "confidence": 0.9,
              "evidence": "Observed `address.street` field containing 'Cmd Alley; ls -la /;'",
              "explanation": "The presence of 'Cmd Alley; ls -la /;' in the `address.street` field is a strong indicator of an attempted OS Command Injection. The semicolon (`;`) is a common command separator in many operating systems, allowing an attacker to append additional arbitrary commands. If the backend system processes this street address in a context where it is directly used within a shell command (e.g., for logging, file creation, or an external system call), the `ls -la /` command would be executed on the server. This allows an attacker to execute arbitrary commands, leading to system compromise, data exfiltration, or denial of service."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T02:40:24.072876",
      "node_name": "createUser_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "createUser": {
            "id": "11",
            "name": "Path Traversal",
            "address": {
              "street": "../../../etc/passwd"
            }
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Path Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "Path injection vulnerability detected - file system access patterns found",
            "evidence": "Response status: 200, Path injection patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Path Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The response shows a user's address containing '../../../etc/passwd' in the 'street' field. This pattern is a classic indicator of a directory traversal attempt. If this input is then used by the backend to construct a file path or URL without proper sanitization, it could lead to the server attempting to access or expose arbitrary files (such as /etc/passwd) from the underlying file system. This indicates a potential path injection vulnerability where an attacker could manipulate file paths.",
            "evidence": "'address': { 'street': '../../../etc/passwd' }",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Path Injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "'address': { 'street': '../../../etc/passwd' }",
              "explanation": "The response shows a user's address containing '../../../etc/passwd' in the 'street' field. This pattern is a classic indicator of a directory traversal attempt. If this input is then used by the backend to construct a file path or URL without proper sanitization, it could lead to the server attempting to access or expose arbitrary files (such as /etc/passwd) from the underlying file system. This indicates a potential path injection vulnerability where an attacker could manipulate file paths."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T02:40:25.662445",
      "node_name": "createUser_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "createUser": {
            "id": "11",
            "name": "<b>HTML Injection</b>",
            "email": "html@example.com"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: HTML Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The 'name' field in the 'createUser' response contains unescaped HTML tags (<b>). This indicates a potential HTML Injection vulnerability. If this content is rendered directly by a client-side application (e.g., a web browser), the bold tags would be interpreted and rendered, allowing an attacker to inject arbitrary HTML. While not directly XSS (as no script is observed executing), it's a precursor and can lead to UI defacement, phishing, or other client-side attacks.",
            "evidence": "'name': '<b>HTML Injection</b>'",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "HTML Injection",
              "severity": "MEDIUM",
              "confidence": 0.9,
              "evidence": "'name': '<b>HTML Injection</b>'",
              "explanation": "The 'name' field in the 'createUser' response contains unescaped HTML tags (<b>). This indicates a potential HTML Injection vulnerability. If this content is rendered directly by a client-side application (e.g., a web browser), the bold tags would be interpreted and rendered, allowing an attacker to inject arbitrary HTML. While not directly XSS (as no script is observed executing), it's a precursor and can lead to UI defacement, phishing, or other client-side attacks."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T02:40:27.715364",
      "node_name": "createUser_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T02:40:29.722972",
      "node_name": "createUser_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T02:40:32.655670",
      "node_name": "createUser_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Syntax Error: Expected \"$\", found Name \"input\".",
            "locations": [
              {
                "line": 2,
                "column": 21
              }
            ],
            "extensions": {
              "code": "GRAPHQL_PARSE_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T02:40:33.998438",
      "node_name": "createUser_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Syntax Error: Expected \"$\", found Name \"input\".",
            "locations": [
              {
                "line": 2,
                "column": 21
              }
            ],
            "extensions": {
              "code": "GRAPHQL_PARSE_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}