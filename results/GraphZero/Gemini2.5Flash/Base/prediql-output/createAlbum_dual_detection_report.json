{
  "report_timestamp": "2025-10-05T01:41:26.020254",
  "api_url": "https://graphqlzero.almansi.me/api",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.2,
    "simple_detections": 4,
    "llm_detections": 4,
    "consensus_breakdown": {
      "simple_only": 1,
      "both_detected": 3,
      "no_vulnerabilities": 5,
      "llm_only": 1
    },
    "detection_ratio": 1.0,
    "potential_analysis": {
      "potential_agreement_rate": 0.1,
      "simple_potential_detections": 3,
      "llm_potential_detections": 1,
      "potential_consensus_breakdown": {
        "simple_potential_only": 2,
        "no_potential": 7,
        "both_potential": 1
      },
      "potential_detection_ratio": 0.3333333333333333
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-05T01:41:10.218130",
      "node_name": "createAlbum_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "Album'; DROP TABLE users; --"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "SQL Injection (SQLi) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SQL injection vulnerability detected - malicious SQL patterns found in response",
            "evidence": "Response status: 200, SQL patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Injection Attacks"
        ],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "simple_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T01:41:11.713221",
      "node_name": "createAlbum_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "<script>alert('XSS Payload');</script>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Cross-Site Scripting (XSS) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "XSS injection vulnerability detected - malicious script patterns found in response",
            "evidence": "Response status: 200, XSS patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'title' field in the 'createAlbum' response directly reflects a script tag without proper escaping or sanitization. This indicates a potential Cross-Site Scripting (XSS) vulnerability. If this reflected content is rendered in a web browser, the embedded script will execute, allowing an attacker to perform actions such as stealing user cookies, defacing the website, or redirecting users to malicious sites.",
            "evidence": "<script>alert('XSS Payload');</script>",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "<script>alert('XSS Payload');</script>",
              "explanation": "The 'title' field in the 'createAlbum' response directly reflects a script tag without proper escaping or sanitization. This indicates a potential Cross-Site Scripting (XSS) vulnerability. If this reflected content is rendered in a web browser, the embedded script will execute, allowing an attacker to perform actions such as stealing user cookies, defacing the website, or redirecting users to malicious sites."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T01:41:13.424779",
      "node_name": "createAlbum_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "My Album"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T01:41:15.478580",
      "node_name": "createAlbum_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "Album; rm -rf /; echo"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: OS Command Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response shows that the input 'Album; rm -rf /; echo' was successfully processed and reflected in the 'title' field. The inclusion of the shell command 'rm -rf /' strongly suggests that the backend is executing the input as a shell command rather than treating it purely as data. If the server-side implementation directly incorporates the 'title' field's value into a shell command without proper sanitization or escaping, this could lead to arbitrary OS command execution, including critical commands like 'rm -rf /' which would delete all files on the system. The 'echo' command following the destructive 'rm' command might indicate an attempt to restore normal output or serve as a delimiter. This is a clear indicator of a potential OS Command Injection vulnerability.",
            "evidence": "'title': 'Album; rm -rf /; echo'",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "OS Command Injection",
              "severity": "CRITICAL",
              "confidence": 0.9,
              "evidence": "'title': 'Album; rm -rf /; echo'",
              "explanation": "The GraphQL response shows that the input 'Album; rm -rf /; echo' was successfully processed and reflected in the 'title' field. The inclusion of the shell command 'rm -rf /' strongly suggests that the backend is executing the input as a shell command rather than treating it purely as data. If the server-side implementation directly incorporates the 'title' field's value into a shell command without proper sanitization or escaping, this could lead to arbitrary OS command execution, including critical commands like 'rm -rf /' which would delete all files on the system. The 'echo' command following the destructive 'rm' command might indicate an attempt to restore normal output or serve as a delimiter. This is a clear indicator of a potential OS Command Injection vulnerability."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T01:41:17.134681",
      "node_name": "createAlbum_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "Album Name"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T01:41:18.815411",
      "node_name": "createAlbum_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "<h1>Important Album</h1><img src='x' onerror='alert(document.cookie)'>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "HTML Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "HTML injection vulnerability detected - HTML markup found in response",
            "evidence": "Response status: 200, HTML patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: HTML Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The 'title' field in the 'createAlbum' GraphQL response directly embeds unescaped HTML content, including an image tag with an onerror event handler. This indicates a clear HTML Injection vulnerability. If this title is rendered in a web browser without proper sanitization, it could lead to Cross-Site Scripting (XSS) by executing arbitrary JavaScript (e.g., 'alert(document.cookie)'). While the immediate response shows the injection, the severity is marked as MEDIUM assuming typical browser rendering would trigger the XSS payload. If the application is a mobile app or CLI that doesn't render HTML, the direct impact is lower, but the underlying vulnerability in handling user-supplied data remains.",
            "evidence": "'title' field contains: \"<h1>Important Album</h1><img src='x' onerror='alert(document.cookie)'>\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "HTML Injection",
              "severity": "MEDIUM",
              "confidence": 0.9,
              "evidence": "'title' field contains: \"<h1>Important Album</h1><img src='x' onerror='alert(document.cookie)'>\"",
              "explanation": "The 'title' field in the 'createAlbum' GraphQL response directly embeds unescaped HTML content, including an image tag with an onerror event handler. This indicates a clear HTML Injection vulnerability. If this title is rendered in a web browser without proper sanitization, it could lead to Cross-Site Scripting (XSS) by executing arbitrary JavaScript (e.g., 'alert(document.cookie)'). While the immediate response shows the injection, the severity is marked as MEDIUM assuming typical browser rendering would trigger the XSS payload. If the application is a mobile app or CLI that doesn't render HTML, the direct impact is lower, but the underlying vulnerability in handling user-supplied data remains."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [
            "Injection Attacks"
          ],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 1.0,
          "potential_consensus": "both_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T01:41:20.582638",
      "node_name": "createAlbum_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T01:41:22.391742",
      "node_name": "createAlbum_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T01:41:24.054270",
      "node_name": "createAlbum_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"createAlbum\" on type \"Query\".",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T01:41:26.017283",
      "node_name": "createAlbum_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"tiile\" on type \"Album\". Did you mean \"title\"?",
            "locations": [
              {
                "line": 5,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Information Disclosure",
            "detection": "safe",
            "category": "Injection Attacks",
            "description": "The GraphQL response explicitly suggests a correct field name ('title') in its error message when an invalid field name ('tiile') was queried. This behavior, known as 'field suggestion' or 'schema introspection on error', is an information disclosure vulnerability. It allows an attacker to progressively guess valid field names by submitting slightly altered or misspelled versions, thereby mapping out the schema without requiring explicit introspection queries or authentication for schema access. While not directly exposing sensitive data in this instance, it facilitates an attacker's reconnaissance efforts against the API's data model.",
            "evidence": "message: \"Cannot query field \\\"tiile\\\" on type \\\"Album\\\". Did you mean \\\"title\\\"?\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Information Disclosure",
              "severity": "LOW",
              "confidence": 0.9,
              "evidence": "message: \"Cannot query field \\\"tiile\\\" on type \\\"Album\\\". Did you mean \\\"title\\\"?\"",
              "explanation": "The GraphQL response explicitly suggests a correct field name ('title') in its error message when an invalid field name ('tiile') was queried. This behavior, known as 'field suggestion' or 'schema introspection on error', is an information disclosure vulnerability. It allows an attacker to progressively guess valid field names by submitting slightly altered or misspelled versions, thereby mapping out the schema without requiring explicit introspection queries or authentication for schema access. While not directly exposing sensitive data in this instance, it facilitates an attacker's reconnaissance efforts against the API's data model."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 1,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Information Disclosure",
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}