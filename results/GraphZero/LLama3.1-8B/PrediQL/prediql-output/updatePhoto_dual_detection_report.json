{
  "report_timestamp": "2025-10-05T20:13:01.037150",
  "api_url": "https://graphqlzero.almansi.me/api",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.4,
    "simple_detections": 5,
    "llm_detections": 5,
    "consensus_breakdown": {
      "no_vulnerabilities": 5,
      "both_detected": 5
    },
    "detection_ratio": 1.0,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 4,
      "llm_potential_detections": 0,
      "potential_consensus_breakdown": {
        "no_potential": 6,
        "simple_potential_only": 4
      },
      "potential_detection_ratio": 0.0
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-05T20:12:42.566554",
      "node_name": "updatePhoto_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": null,
            "title": "SQL Inject Attempt"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:12:44.288111",
      "node_name": "updatePhoto_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "2",
            "title": "<script>alert('XSS')</script>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Cross-Site Scripting (XSS) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "XSS injection vulnerability detected - malicious script patterns found in response",
            "evidence": "Response status: 200, XSS patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response reflects the input '<script>alert('XSS')</script>' directly into the 'title' field. If this response is rendered in a web browser without proper sanitization or encoding, it will execute the embedded JavaScript, leading to a Cross-Site Scripting (XSS) vulnerability. This indicates that the server-side application is not adequately validating or sanitizing user-supplied data before returning it in the API response.",
            "evidence": "'<script>alert('XSS')</script>' found in 'title' field within the response body.",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "'<script>alert('XSS')</script>' found in 'title' field within the response body.",
              "explanation": "The GraphQL response reflects the input '<script>alert('XSS')</script>' directly into the 'title' field. If this response is rendered in a web browser without proper sanitization or encoding, it will execute the embedded JavaScript, leading to a Cross-Site Scripting (XSS) vulnerability. This indicates that the server-side application is not adequately validating or sanitizing user-supplied data before returning it in the API response."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:12:46.966328",
      "node_name": "updatePhoto_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "3",
            "title": "SSRF Test",
            "url": "http://169.254.169.254/latest/meta-data/"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Server-Side Request Forgery (SSRF) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SSRF injection vulnerability detected - internal network access patterns found",
            "evidence": "Response status: 200, SSRF keywords detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: ssrf_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The presence of 'http://169.254.169.254/latest/meta-data/' in the 'url' field is a strong indicator of an SSRF (Server-Side Request Forgery) vulnerability. This internal IP address is commonly used to access sensitive instance metadata on AWS EC2 instances. If an attacker can control the 'url' parameter to make the GraphQL API server fetch this internal resource, it means the server is making requests to an attacker-controlled internal address. This can lead to information disclosure of sensitive cloud instance credentials and other metadata. The successful inclusion of this internal URL in the response strongly suggests that the server processed and likely made a request to this internal endpoint as part of the 'updatePhoto' operation.",
            "evidence": "The 'url' field in the 'updatePhoto' response contains 'http://169.254.169.254/latest/meta-data/'. This IP address (169.254.169.254) is a well-known AWS EC2 metadata service endpoint.",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "ssrf_injection",
              "severity": "CRITICAL",
              "confidence": 0.9,
              "evidence": "The 'url' field in the 'updatePhoto' response contains 'http://169.254.169.254/latest/meta-data/'. This IP address (169.254.169.254) is a well-known AWS EC2 metadata service endpoint.",
              "explanation": "The presence of 'http://169.254.169.254/latest/meta-data/' in the 'url' field is a strong indicator of an SSRF (Server-Side Request Forgery) vulnerability. This internal IP address is commonly used to access sensitive instance metadata on AWS EC2 instances. If an attacker can control the 'url' parameter to make the GraphQL API server fetch this internal resource, it means the server is making requests to an attacker-controlled internal address. This can lead to information disclosure of sensitive cloud instance credentials and other metadata. The successful inclusion of this internal URL in the response strongly suggests that the server processed and likely made a request to this internal endpoint as part of the 'updatePhoto' operation."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:12:48.413447",
      "node_name": "updatePhoto_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "4",
            "title": "OS Command Injection Test"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:12:51.045203",
      "node_name": "updatePhoto_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "5",
            "title": "Path Injection Test",
            "url": "https://example.com/../../../../../etc/passwd"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Path Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "Path injection vulnerability detected - file system access patterns found",
            "evidence": "Response status: 200, Path injection patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Path Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'url' field in the 'updatePhoto' response contains a value 'https://example.com/../../../../../etc/passwd'. The '..' (dot-dot-slash) sequences are a classic indicator of a directory traversal attempt. While this specific URL is an external link, the server's acceptance and reflection of such a path manipulation within a URL field suggests that the application might not be properly validating or sanitizing user-supplied URLs. If this URL were to be used by a server-side component (e.g., to fetch image data, perform a redirect, or store a file path internally), it could lead to an SSRF vulnerability accessing local files like /etc/passwd, or even a local file inclusion/disclosure vulnerability if the application attempts to process this path on its own file system. The presence of '/etc/passwd' specifically points towards an attempt to access sensitive system files. This indicates a potential path injection vulnerability where an attacker could manipulate paths to access arbitrary files or resources on the server or internal network. By crafting a malicious URL with directory traversal sequences, an attacker might be able to read sensitive files, execute arbitrary commands, or even write files to arbitrary locations, depending on how this URL is processed by the backend.",
            "evidence": "'url': 'https://example.com/../../../../../etc/passwd'",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Path Injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "'url': 'https://example.com/../../../../../etc/passwd'",
              "explanation": "The 'url' field in the 'updatePhoto' response contains a value 'https://example.com/../../../../../etc/passwd'. The '..' (dot-dot-slash) sequences are a classic indicator of a directory traversal attempt. While this specific URL is an external link, the server's acceptance and reflection of such a path manipulation within a URL field suggests that the application might not be properly validating or sanitizing user-supplied URLs. If this URL were to be used by a server-side component (e.g., to fetch image data, perform a redirect, or store a file path internally), it could lead to an SSRF vulnerability accessing local files like /etc/passwd, or even a local file inclusion/disclosure vulnerability if the application attempts to process this path on its own file system. The presence of '/etc/passwd' specifically points towards an attempt to access sensitive system files. This indicates a potential path injection vulnerability where an attacker could manipulate paths to access arbitrary files or resources on the server or internal network. By crafting a malicious URL with directory traversal sequences, an attacker might be able to read sensitive files, execute arbitrary commands, or even write files to arbitrary locations, depending on how this URL is processed by the backend."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:12:52.873197",
      "node_name": "updatePhoto_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "6",
            "title": "<h1>HTML Injection</h1><img src='x' onerror='alert(\"HTML\")'>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "HTML Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "HTML injection vulnerability detected - HTML markup found in response",
            "evidence": "Response status: 200, HTML patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: HTML Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'title' field in the 'updatePhoto' response contains unescaped HTML content, specifically an H1 tag and an image tag with an onerror event handler. This indicates a clear HTML injection vulnerability. If this content is rendered directly by a web browser without proper sanitization, it could lead to Cross-Site Scripting (XSS) due to the onerror attribute, or at the very least, arbitrary HTML content being displayed, allowing an attacker to manipulate the page's structure and content.",
            "evidence": "'title': '<h1>HTML Injection</h1><img src='x' onerror='alert(\"HTML\")'>'",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "HTML Injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "'title': '<h1>HTML Injection</h1><img src='x' onerror='alert(\"HTML\")'>'",
              "explanation": "The 'title' field in the 'updatePhoto' response contains unescaped HTML content, specifically an H1 tag and an image tag with an onerror event handler. This indicates a clear HTML injection vulnerability. If this content is rendered directly by a web browser without proper sanitization, it could lead to Cross-Site Scripting (XSS) due to the onerror attribute, or at the very least, arbitrary HTML content being displayed, allowing an attacker to manipulate the page's structure and content."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:12:55.360733",
      "node_name": "updatePhoto_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:12:57.039459",
      "node_name": "updatePhoto_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:12:58.839986",
      "node_name": "updatePhoto_response_10",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "9",
            "title": "Introspection Test",
            "__typename": "Photo"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:13:01.034528",
      "node_name": "updatePhoto_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"tilte\" on type \"Photo\". Did you mean \"title\"?",
            "locations": [
              {
                "line": 5,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Information Disclosure",
            "detection": "safe",
            "category": "Injection Attacks",
            "description": "The GraphQL response explicitly suggests a valid field name ('title') in response to a mistyped field ('tilte'). This behavior is known as 'field suggestion' and is a form of information disclosure. While not directly exploitable for critical attacks, it can aid attackers in mapping out the API schema, making subsequent attacks like reconnaissance or exploiting other vulnerabilities easier. This falls under Information Disclosure as it exposes valid schema details that an attacker might not otherwise know.",
            "evidence": "Cannot query field \"tilte\" on type \"Photo\". Did you mean \"title\"?",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Information Disclosure",
              "severity": "LOW",
              "confidence": 0.9,
              "evidence": "Cannot query field \"tilte\" on type \"Photo\". Did you mean \"title\"?",
              "explanation": "The GraphQL response explicitly suggests a valid field name ('title') in response to a mistyped field ('tilte'). This behavior is known as 'field suggestion' and is a form of information disclosure. While not directly exploitable for critical attacks, it can aid attackers in mapping out the API schema, making subsequent attacks like reconnaissance or exploiting other vulnerabilities easier. This falls under Information Disclosure as it exposes valid schema details that an attacker might not otherwise know."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 1,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}