{
  "report_timestamp": "2025-10-05T20:02:39.062097",
  "api_url": "https://graphqlzero.almansi.me/api",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.3,
    "simple_detections": 5,
    "llm_detections": 5,
    "consensus_breakdown": {
      "simple_only": 1,
      "both_detected": 4,
      "no_vulnerabilities": 4,
      "llm_only": 1
    },
    "detection_ratio": 1.0,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 4,
      "llm_potential_detections": 0,
      "potential_consensus_breakdown": {
        "simple_potential_only": 4,
        "no_potential": 6
      },
      "potential_detection_ratio": 0.0
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-05T20:02:21.299118",
      "node_name": "createAlbum_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "Album'; DROP TABLE users; --"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "SQL Injection (SQLi) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SQL injection vulnerability detected - malicious SQL patterns found in response",
            "evidence": "Response status: 200, SQL patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Injection Attacks"
        ],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "simple_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:02:23.152753",
      "node_name": "createAlbum_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "<script>alert('XSS')</script>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Cross-Site Scripting (XSS) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "XSS injection vulnerability detected - malicious script patterns found in response",
            "evidence": "Response status: 200, XSS patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'title' field in the GraphQL response reflects the input containing a script tag (<script>alert('XSS')</script>) without proper sanitization. This indicates a reflected Cross-Site Scripting (XSS) vulnerability. If this reflected content is rendered directly in a web browser, the embedded script would execute, potentially leading to session hijacking, defacement, or other client-side attacks.",
            "evidence": "\"title\": \"<script>alert('XSS')</script>\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "\"title\": \"<script>alert('XSS')</script>\"",
              "explanation": "The 'title' field in the GraphQL response reflects the input containing a script tag (<script>alert('XSS')</script>) without proper sanitization. This indicates a reflected Cross-Site Scripting (XSS) vulnerability. If this reflected content is rendered directly in a web browser, the embedded script would execute, potentially leading to session hijacking, defacement, or other client-side attacks."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:02:24.624478",
      "node_name": "createAlbum_response_4",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Field \"coverImageUrl\" is not defined by type \"CreateAlbumInput\".",
            "locations": [
              {
                "line": 3,
                "column": 58
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:02:26.645564",
      "node_name": "createAlbum_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "My Album; rm -rf /; "
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: os_command_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'title' field in the GraphQL response contains the string 'My Album; rm -rf /; '. The presence of a semicolon followed by a dangerous shell command like 'rm -rf /' strongly suggests an attempt at OS command injection. If this input is processed by a backend system without proper sanitization and directly incorporated into an OS command, it could lead to arbitrary command execution on the server, resulting in severe data loss or system compromise. While this response only shows the reflection of the injected command and not its actual execution, it indicates a high likelihood that the input is being treated as a command separator and subsequently interpreted by a shell interpreter if not properly handled at the server-side.",
            "evidence": "'title': 'My Album; rm -rf /; '",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "os_command_injection",
              "severity": "CRITICAL",
              "confidence": 0.8,
              "evidence": "'title': 'My Album; rm -rf /; '",
              "explanation": "The 'title' field in the GraphQL response contains the string 'My Album; rm -rf /; '. The presence of a semicolon followed by a dangerous shell command like 'rm -rf /' strongly suggests an attempt at OS command injection. If this input is processed by a backend system without proper sanitization and directly incorporated into an OS command, it could lead to arbitrary command execution on the server, resulting in severe data loss or system compromise. While this response only shows the reflection of the injected command and not its actual execution, it indicates a high likelihood that the input is being treated as a command separator and subsequently interpreted by a shell interpreter if not properly handled at the server-side."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:02:28.720645",
      "node_name": "createAlbum_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "../../etc/passwd"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Path Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "Path injection vulnerability detected - file system access patterns found",
            "evidence": "Response status: 200, Path injection patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Path Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The response shows that the 'title' field, which is likely intended for a user-provided string, successfully accepted and reflected the path traversal sequence '../../etc/passwd'. This strongly suggests that the backend might be using the value of the 'title' field in a file system operation without proper sanitization or validation. If this value is then used in conjunction with file system operations (e.g., creating a file, reading a file, or constructing a path for a resource), it could lead to directory traversal, allowing an attacker to access or manipulate files outside of the intended directory. The presence of '../../etc/passwd' is a classic indicator of an attempted and potentially successful path traversal.",
            "evidence": "'../../etc/passwd' being present in the 'title' field of the 'createAlbum' mutation response.",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Path Injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "'../../etc/passwd' being present in the 'title' field of the 'createAlbum' mutation response.",
              "explanation": "The response shows that the 'title' field, which is likely intended for a user-provided string, successfully accepted and reflected the path traversal sequence '../../etc/passwd'. This strongly suggests that the backend might be using the value of the 'title' field in a file system operation without proper sanitization or validation. If this value is then used in conjunction with file system operations (e.g., creating a file, reading a file, or constructing a path for a resource), it could lead to directory traversal, allowing an attacker to access or manipulate files outside of the intended directory. The presence of '../../etc/passwd' is a classic indicator of an attempted and potentially successful path traversal."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:02:30.732723",
      "node_name": "createAlbum_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "createAlbum": {
            "id": "101",
            "title": "<h1>Important Album</h1><img src='invalid.jpg' onerror='alert(\"HTML Injection\")'>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "HTML Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "HTML injection vulnerability detected - HTML markup found in response",
            "evidence": "Response status: 200, HTML patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: HTML Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'title' field in the 'createAlbum' mutation response contains raw HTML tags, specifically `<h1>` and an `<img>` tag with an `onerror` attribute containing JavaScript. This indicates that the server is not properly sanitizing or encoding user-supplied input before reflecting it in the API response. If this 'title' is subsequently rendered in a web browser without proper encoding, it will lead to an HTML Injection vulnerability, and potentially an XSS vulnerability due to the `onerror='alert(\"HTML Injection\")'` attribute. The presence of such active content within a seemingly data-oriented field is a clear sign of this vulnerability.",
            "evidence": "'title': '<h1>Important Album</h1><img src='invalid.jpg' onerror='alert(\"HTML Injection\")>'",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "HTML Injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "'title': '<h1>Important Album</h1><img src='invalid.jpg' onerror='alert(\"HTML Injection\")>'",
              "explanation": "The 'title' field in the 'createAlbum' mutation response contains raw HTML tags, specifically `<h1>` and an `<img>` tag with an `onerror` attribute containing JavaScript. This indicates that the server is not properly sanitizing or encoding user-supplied input before reflecting it in the API response. If this 'title' is subsequently rendered in a web browser without proper encoding, it will lead to an HTML Injection vulnerability, and potentially an XSS vulnerability due to the `onerror='alert(\"HTML Injection\")'` attribute. The presence of such active content within a seemingly data-oriented field is a clear sign of this vulnerability."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:02:33.137126",
      "node_name": "createAlbum_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:02:35.241514",
      "node_name": "createAlbum_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:02:37.208991",
      "node_name": "createAlbum_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"createAlbum\" on type \"Query\".",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:02:39.059030",
      "node_name": "createAlbum_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"ttl\" on type \"Album\". Did you mean \"title\"?",
            "locations": [
              {
                "line": 5,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Information Disclosure",
            "detection": "safe",
            "category": "Injection Attacks",
            "description": "The GraphQL response explicitly suggests a correct field name (\"title\") when an incorrect one (\"ttl\") was provided. This behavior, known as 'field suggestion', is a form of Information Disclosure. While not directly exploitable in most cases, it helps attackers enumerate valid fields and understand the API schema, making subsequent attacks (e.g., information gathering, brute-forcing queries) easier to conduct. This can be particularly useful in conjunction with other vulnerabilities or for reconnaissance phases.",
            "evidence": "message: \"Cannot query field \"ttl\" on type \"Album\". Did you mean \"title\"?\"",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Information Disclosure",
              "severity": "LOW",
              "confidence": 0.8,
              "evidence": "message: \"Cannot query field \"ttl\" on type \"Album\". Did you mean \"title\"?\"",
              "explanation": "The GraphQL response explicitly suggests a correct field name (\"title\") when an incorrect one (\"ttl\") was provided. This behavior, known as 'field suggestion', is a form of Information Disclosure. While not directly exploitable in most cases, it helps attackers enumerate valid fields and understand the API schema, making subsequent attacks (e.g., information gathering, brute-forcing queries) easier to conduct. This can be particularly useful in conjunction with other vulnerabilities or for reconnaissance phases."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 1,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}