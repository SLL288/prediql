{
  "report_timestamp": "2025-10-05T20:11:56.401278",
  "api_url": "https://graphqlzero.almansi.me/api",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.5,
    "simple_detections": 6,
    "llm_detections": 6,
    "consensus_breakdown": {
      "both_detected": 6,
      "no_vulnerabilities": 4
    },
    "detection_ratio": 1.0,
    "potential_analysis": {
      "potential_agreement_rate": 0.1,
      "simple_potential_detections": 5,
      "llm_potential_detections": 1,
      "potential_consensus_breakdown": {
        "simple_potential_only": 4,
        "no_potential": 5,
        "both_potential": 1
      },
      "potential_detection_ratio": 0.2
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-05T20:11:39.339664",
      "node_name": "createPhoto_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "createPhoto": {
            "id": "5001",
            "title": "SQL Injection Test'; DROP TABLE Photos; --"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "SQL Injection (SQLi) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SQL injection vulnerability detected - malicious SQL patterns found in response",
            "evidence": "Response status: 200, SQL patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: sql_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'title' field in the GraphQL response contains the string \"SQL Injection Test'; DROP TABLE Photos; --\". This is a classic SQL injection payload designed to terminate the current SQL query and then execute a 'DROP TABLE Photos;' command. The fact that this specific malicious string is reflected directly into a data field suggests that the input was processed as part of an SQL query without proper sanitization or parameterization. If this string was used to insert or update a database record, it could have led to the deletion of the 'Photos' table, indicating a severe SQL injection vulnerability.",
            "evidence": "' DROP TABLE Photos; --",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "sql_injection",
              "severity": "CRITICAL",
              "confidence": 0.9,
              "evidence": "' DROP TABLE Photos; --",
              "explanation": "The 'title' field in the GraphQL response contains the string \"SQL Injection Test'; DROP TABLE Photos; --\". This is a classic SQL injection payload designed to terminate the current SQL query and then execute a 'DROP TABLE Photos;' command. The fact that this specific malicious string is reflected directly into a data field suggests that the input was processed as part of an SQL query without proper sanitization or parameterization. If this string was used to insert or update a database record, it could have led to the deletion of the 'Photos' table, indicating a severe SQL injection vulnerability."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:11:41.557059",
      "node_name": "createPhoto_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "createPhoto": {
            "id": "5001",
            "title": "<script>alert('XSS_SUCCESS');</script>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Cross-Site Scripting (XSS) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "XSS injection vulnerability detected - malicious script patterns found in response",
            "evidence": "Response status: 200, XSS patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'title' field in the GraphQL response contains an unescaped '<script>alert('XSS_SUCCESS');</script>' tag. If this response is rendered directly in a web browser without proper sanitization or encoding, it will execute the JavaScript code 'alert(\"XSS_SUCCESS\")', indicating a successful Cross-Site Scripting (XSS) injection. This allows an attacker to inject arbitrary client-side scripts, potentially leading to session hijacking, defacement, or other malicious activities.",
            "evidence": "\"title\": \"<script>alert('XSS_SUCCESS');</script>\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "\"title\": \"<script>alert('XSS_SUCCESS');</script>\"",
              "explanation": "The 'title' field in the GraphQL response contains an unescaped '<script>alert('XSS_SUCCESS');</script>' tag. If this response is rendered directly in a web browser without proper sanitization or encoding, it will execute the JavaScript code 'alert(\"XSS_SUCCESS\")', indicating a successful Cross-Site Scripting (XSS) injection. This allows an attacker to inject arbitrary client-side scripts, potentially leading to session hijacking, defacement, or other malicious activities."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:11:44.045623",
      "node_name": "createPhoto_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "createPhoto": {
            "id": "5001",
            "url": "http://169.254.169.254/latest/meta-data/hostname"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Server-Side Request Forgery (SSRF) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SSRF injection vulnerability detected - internal network access patterns found",
            "evidence": "Response status: 200, SSRF keywords detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: ssrf_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The 'url' field in the response body contains 'http://169.254.169.254/latest/meta-data/hostname'. This IP address (169.254.169.254) is a well-known IPv4 link-local address used by AWS EC2 instances to access metadata services. The path '/latest/meta-data/hostname' specifically requests the hostname from the instance metadata. The fact that the application is attempting to fetch or has successfully fetched content from this internal metadata service indicates a Server-Side Request Forgery (SSRF) vulnerability. An attacker can manipulate the input to the 'createPhoto' mutation to induce the server to make requests to internal services or external arbitrary URLs.",
            "evidence": "\"url\": \"http://169.254.169.254/latest/meta-data/hostname\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "ssrf_injection",
              "severity": "CRITICAL",
              "confidence": 0.9,
              "evidence": "\"url\": \"http://169.254.169.254/latest/meta-data/hostname\"",
              "explanation": "The 'url' field in the response body contains 'http://169.254.169.254/latest/meta-data/hostname'. This IP address (169.254.169.254) is a well-known IPv4 link-local address used by AWS EC2 instances to access metadata services. The path '/latest/meta-data/hostname' specifically requests the hostname from the instance metadata. The fact that the application is attempting to fetch or has successfully fetched content from this internal metadata service indicates a Server-Side Request Forgery (SSRF) vulnerability. An attacker can manipulate the input to the 'createPhoto' mutation to induce the server to make requests to internal services or external arbitrary URLs."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:11:45.646598",
      "node_name": "createPhoto_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "createPhoto": {
            "id": "5001",
            "title": "Command Injection Test"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:11:47.173880",
      "node_name": "createPhoto_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "createPhoto": {
            "id": "5001",
            "url": "file:///etc/passwd"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Path Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "Path injection vulnerability detected - file system access patterns found",
            "evidence": "Response status: 200, Path injection patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Path Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response explicitly returns a 'url' field with the value 'file:///etc/passwd'. This indicates direct file system access and exposure of a sensitive system file, '/etc/passwd', which contains user account information. This is a clear sign of a Path Injection vulnerability, potentially leading to unauthorized access to arbitrary files on the server.",
            "evidence": "url: \"file:///etc/passwd\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Path Injection",
              "severity": "CRITICAL",
              "confidence": 0.9,
              "evidence": "url: \"file:///etc/passwd\"",
              "explanation": "The GraphQL response explicitly returns a 'url' field with the value 'file:///etc/passwd'. This indicates direct file system access and exposure of a sensitive system file, '/etc/passwd', which contains user account information. This is a clear sign of a Path Injection vulnerability, potentially leading to unauthorized access to arbitrary files on the server."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:11:49.032551",
      "node_name": "createPhoto_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "createPhoto": {
            "id": "5001",
            "title": "<h1>Important Notice!</h1>"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "HTML Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "HTML injection vulnerability detected - HTML markup found in response",
            "evidence": "Response status: 200, HTML patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: HTML Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The 'title' field in the 'createPhoto' mutation response contains raw HTML tags (<h1>). This indicates that the server is accepting and reflecting user-supplied input without proper HTML sanitization or encoding. If this 'title' is subsequently rendered in a web browser without escaping, it would lead to HTML injection, allowing an attacker to manipulate the page's structure and content, or potentially lead to XSS if script tags were allowed.",
            "evidence": "'<h1>Important Notice!</h1>' in the 'title' field within the 'createPhoto' mutation response.",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "HTML Injection",
              "severity": "MEDIUM",
              "confidence": 0.9,
              "evidence": "'<h1>Important Notice!</h1>' in the 'title' field within the 'createPhoto' mutation response.",
              "explanation": "The 'title' field in the 'createPhoto' mutation response contains raw HTML tags (<h1>). This indicates that the server is accepting and reflecting user-supplied input without proper HTML sanitization or encoding. If this 'title' is subsequently rendered in a web browser without escaping, it would lead to HTML injection, allowing an attacker to manipulate the page's structure and content, or potentially lead to XSS if script tags were allowed."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [
            "Injection Attacks"
          ],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 1.0,
          "potential_consensus": "both_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:11:50.845190",
      "node_name": "createPhoto_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:11:53.068702",
      "node_name": "createPhoto_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:11:54.700892",
      "node_name": "createPhoto_response_10",
      "response_status": 200,
      "response_body": {
        "data": {
          "createPhoto": {
            "id": "5001",
            "__typename": "Photo"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T20:11:56.397121",
      "node_name": "createPhoto_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"titlle\" on type \"Photo\". Did you mean \"title\"?",
            "locations": [
              {
                "line": 9,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Information Disclosure",
            "detection": "safe",
            "category": "Injection Attacks",
            "description": "The GraphQL response explicitly suggests a correct field name ('title') in its error message when an incorrect field name ('titlle') is provided. This behavior, known as 'field suggestion', is a form of information disclosure. It can assist attackers in mapping out the API's schema and discovering valid fields without needing prior knowledge or introspection, which could be a stepping stone for further attacks or simply ease the process of understanding the API's structure for unauthorized users.",
            "evidence": "message\": \"Cannot query field \\\"titlle\\\" on type \\\"Photo\\\". Did you mean \\\"title\\\"?\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Information Disclosure",
              "severity": "LOW",
              "confidence": 0.9,
              "evidence": "message\": \"Cannot query field \\\"titlle\\\" on type \\\"Photo\\\". Did you mean \\\"title\\\"?\"",
              "explanation": "The GraphQL response explicitly suggests a correct field name ('title') in its error message when an incorrect field name ('titlle') is provided. This behavior, known as 'field suggestion', is a form of information disclosure. It can assist attackers in mapping out the API's schema and discovering valid fields without needing prior knowledge or introspection, which could be a stepping stone for further attacks or simply ease the process of understanding the API's structure for unauthorized users."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 1,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}