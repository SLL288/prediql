{
  "report_timestamp": "2025-10-05T21:16:54.687915",
  "api_url": "https://graphqlzero.almansi.me/api",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.0,
    "simple_detections": 1,
    "llm_detections": 3,
    "consensus_breakdown": {
      "no_vulnerabilities": 7,
      "llm_only": 2,
      "both_detected": 1
    },
    "detection_ratio": 3.0,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 0,
      "llm_potential_detections": 3,
      "potential_consensus_breakdown": {
        "no_potential": 7,
        "llm_potential_only": 3
      },
      "potential_detection_ratio": Infinity
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-05T21:14:12.722969",
      "node_name": "todos_response_2",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Expected value of type \"SearchOptions\", found \"1' OR '1'='1'; -- \".",
            "locations": [
              {
                "line": 3,
                "column": 61
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:14:33.141240",
      "node_name": "todos_response_3",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Expected value of type \"SearchOptions\", found \"<script>alert('xss')</script>\".",
            "locations": [
              {
                "line": 3,
                "column": 61
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The server's GraphQL error message reflects the exact user-supplied input including a <script> tag without escaping or removing it. This is a reflected HTML/script payload appearing in a JSON error response. If a client (web app) renders that error text into the DOM without proper HTML-encoding or sanitization, the reflected script could execute in users' browsers (reflected XSS). The server-side behavior indicates lack of input sanitization/escaping for error messages, which is a security risk. Mitigation: ensure error messages escape/encode HTML special characters before including user input, or avoid reflecting raw user input back to clients; perform server-side input validation and sanitization.",
            "evidence": "Error message in response: \"Expected value of type \\\"SearchOptions\\\", found \\\"<script>alert('xss')</script>\\\".\"",
            "confidence": 0.85,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "MEDIUM",
              "confidence": 0.85,
              "evidence": "Error message in response: \"Expected value of type \\\"SearchOptions\\\", found \\\"<script>alert('xss')</script>\\\".\"",
              "explanation": "The server's GraphQL error message reflects the exact user-supplied input including a <script> tag without escaping or removing it. This is a reflected HTML/script payload appearing in a JSON error response. If a client (web app) renders that error text into the DOM without proper HTML-encoding or sanitization, the reflected script could execute in users' browsers (reflected XSS). The server-side behavior indicates lack of input sanitization/escaping for error messages, which is a security risk. Mitigation: ensure error messages escape/encode HTML special characters before including user input, or avoid reflecting raw user input back to clients; perform server-side input validation and sanitization."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:14:52.803197",
      "node_name": "todos_response_4",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Expected value of type \"SearchOptions\", found \"http://169.254.169.254/latest/meta-data/iam/security-credentials/\".",
            "locations": [
              {
                "line": 3,
                "column": 61
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:15:07.161347",
      "node_name": "todos_response_5",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Expected value of type \"SearchOptions\", found \"test; cat /etc/passwd\".",
            "locations": [
              {
                "line": 3,
                "column": 61
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:15:25.774545",
      "node_name": "todos_response_6",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Expected value of type \"SearchOptions\", found \"../../etc/passwd\".",
            "locations": [
              {
                "line": 3,
                "column": 61
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:15:40.623582",
      "node_name": "todos_response_7",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Expected value of type \"SearchOptions\", found \"<div onclick=\\\"alert('inject')\\\">click</div>\".",
            "locations": [
              {
                "line": 3,
                "column": 61
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: html_injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The GraphQL error message echoes the user-supplied HTML snippet (<div onclick=\"alert('inject')\">click</div>) verbatim into the JSON response. This is a reflected HTML injection: if a client (for example a web UI) takes this error message and inserts it into a page without proper encoding/escaping, the injected markup/attributes (onclick) could execute, resulting in XSS. The server rejected the input (validation error) but still returned the raw input in the error text, indicating insufficient output encoding/sanitization. Risk depends on how clients render these error messages; if they render raw HTML, this is exploitable. Recommended mitigations: ensure all user-controlled data is properly escaped before embedding into HTML, avoid returning raw user input in messages, and perform server-side input validation and sanitization.",
            "evidence": "Error message reflects input: \"Expected value of type \\\"SearchOptions\\\", found \\\"<div onclick=\\\\\\\"alert('inject')\\\\\\\">click</div>\\\".\"",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "html_injection",
              "severity": "MEDIUM",
              "confidence": 0.8,
              "evidence": "Error message reflects input: \"Expected value of type \\\"SearchOptions\\\", found \\\"<div onclick=\\\\\\\"alert('inject')\\\\\\\">click</div>\\\".\"",
              "explanation": "The GraphQL error message echoes the user-supplied HTML snippet (<div onclick=\"alert('inject')\">click</div>) verbatim into the JSON response. This is a reflected HTML injection: if a client (for example a web UI) takes this error message and inserts it into a page without proper encoding/escaping, the injected markup/attributes (onclick) could execute, resulting in XSS. The server rejected the input (validation error) but still returned the raw input in the error text, indicating insufficient output encoding/sanitization. Risk depends on how clients render these error messages; if they render raw HTML, this is exploitable. Recommended mitigations: ensure all user-controlled data is properly escaped before embedding into HTML, avoid returning raw user input in messages, and perform server-side input validation and sanitization."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:15:53.779230",
      "node_name": "todos_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:16:02.751735",
      "node_name": "todos_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:16:42.503471",
      "node_name": "todos_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"types\" on type \"TodosPage\".",
            "locations": [
              {
                "line": 4,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:16:54.686834",
      "node_name": "todos_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"titlle\" on type \"Todo\". Did you mean \"title\"?",
            "locations": [
              {
                "line": 6,
                "column": 7
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Cannot query field \"comleted\" on type \"Todo\". Did you mean \"completed\"?",
            "locations": [
              {
                "line": 7,
                "column": 7
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Cannot query field \"emaill\" on type \"User\". Did you mean \"email\"?",
            "locations": [
              {
                "line": 11,
                "column": 9
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: field_suggestions",
            "detection": "potential",
            "category": "Unknown",
            "description": "The GraphQL API returns descriptive validation errors that include suggested correct field names. These \"Did you mean ...?\" hints reveal allowed schema field names (title, completed, email), which is an information disclosure vulnerability commonly called field_suggestions. An attacker can use these suggestions to enumerate schema and discover valid fields even if introspection is disabled, improving ability to craft targeted queries or perform further recon. Although this does not directly execute code or access data, leaking schema details increases attack surface and should be treated as a security issue. Mitigation: return generic validation errors or disable suggestion messages in production.",
            "evidence": "Error messages: \"Cannot query field \\\"titlle\\\" on type \\\"Todo\\\". Did you mean \\\"title\\\"?\", \"Cannot query field \\\"comleted\\\" on type \\\"Todo\\\". Did you mean \\\"completed\\\"?\", \"Cannot query field \\\"emaill\\\" on type \\\"User\\\". Did you mean \\\"email\\\"?\"",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "field_suggestions",
              "severity": "MEDIUM",
              "confidence": 0.95,
              "evidence": "Error messages: \"Cannot query field \\\"titlle\\\" on type \\\"Todo\\\". Did you mean \\\"title\\\"?\", \"Cannot query field \\\"comleted\\\" on type \\\"Todo\\\". Did you mean \\\"completed\\\"?\", \"Cannot query field \\\"emaill\\\" on type \\\"User\\\". Did you mean \\\"email\\\"?\"",
              "explanation": "The GraphQL API returns descriptive validation errors that include suggested correct field names. These \"Did you mean ...?\" hints reveal allowed schema field names (title, completed, email), which is an information disclosure vulnerability commonly called field_suggestions. An attacker can use these suggestions to enumerate schema and discover valid fields even if introspection is disabled, improving ability to craft targeted queries or perform further recon. Although this does not directly execute code or access data, leaking schema details increases attack surface and should be treated as a security issue. Mitigation: return generic validation errors or disable suggestion messages in production."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Unknown"
        ],
        "potential_categories": [
          "Unknown"
        ]
      },
      "comparison": {
        "total_categories": [
          "Information Disclosure",
          "Unknown"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Unknown"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Unknown"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Unknown"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}