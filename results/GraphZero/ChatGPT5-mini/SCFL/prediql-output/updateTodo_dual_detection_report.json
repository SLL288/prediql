{
  "report_timestamp": "2025-10-06T00:29:48.011043",
  "api_url": "https://graphqlzero.almansi.me/api",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.2,
    "simple_detections": 6,
    "llm_detections": 4,
    "consensus_breakdown": {
      "simple_only": 3,
      "both_detected": 3,
      "no_vulnerabilities": 3,
      "llm_only": 1
    },
    "detection_ratio": 0.6666666666666666,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 5,
      "llm_potential_detections": 0,
      "potential_consensus_breakdown": {
        "simple_potential_only": 5,
        "no_potential": 5
      },
      "potential_detection_ratio": 0.0
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-06T00:27:37.515512",
      "node_name": "updateTodo_response_1",
      "response_status": 200,
      "response_body": {
        "data": {
          "updateTodo": {
            "id": null,
            "title": "Buy milk'; DROP TABLE users; --",
            "completed": false,
            "user": {
              "id": null,
              "name": null,
              "email": null
            }
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "SQL Injection (SQLi) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SQL injection vulnerability detected - malicious SQL patterns found in response",
            "evidence": "Response status: 200, SQL patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Injection Attacks"
        ],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "simple_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:27:46.319525",
      "node_name": "updateTodo_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "updateTodo": {
            "id": "3",
            "title": "<script>alert('xss')</script> Saved from UI",
            "completed": false,
            "user": {
              "id": "1",
              "name": "Leanne Graham",
              "username": "Bret",
              "email": "Sincere@april.biz"
            }
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Cross-Site Scripting (XSS) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "XSS injection vulnerability detected - malicious script patterns found in response",
            "evidence": "Response status: 200, XSS patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response returns a title value containing an unescaped <script> tag. This indicates the server accepted and stored/returned HTML/JS input without sanitization or output encoding. If any client (web UI) renders this value into the DOM without proper escaping or using safe APIs (e.g., innerHTML), the script will execute (stored/reflected XSS). This is a clear XSS indicator in the response payload and therefore represents a high-risk vulnerability unless the UI guarantees safe encoding before rendering.",
            "evidence": "title field in response contains raw script tag: \"<script>alert('xss')</script> Saved from UI\"",
            "confidence": 0.85,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "HIGH",
              "confidence": 0.85,
              "evidence": "title field in response contains raw script tag: \"<script>alert('xss')</script> Saved from UI\"",
              "explanation": "The GraphQL response returns a title value containing an unescaped <script> tag. This indicates the server accepted and stored/returned HTML/JS input without sanitization or output encoding. If any client (web UI) renders this value into the DOM without proper escaping or using safe APIs (e.g., innerHTML), the script will execute (stored/reflected XSS). This is a clear XSS indicator in the response payload and therefore represents a high-risk vulnerability unless the UI guarantees safe encoding before rendering."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:28:04.549896",
      "node_name": "updateTodo_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "updateTodo": {
            "id": "4",
            "title": "Fetch metadata: http://169.254.169.254/latest/meta-data/iam/security-credentials/",
            "completed": false,
            "user": {
              "id": "1",
              "name": "Leanne Graham",
              "website": "hildegard.org",
              "email": "Sincere@april.biz"
            }
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Server-Side Request Forgery (SSRF) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SSRF injection vulnerability detected - internal network access patterns found",
            "evidence": "Response status: 200, SSRF keywords detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Injection Attacks"
        ],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "simple_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:28:20.074209",
      "node_name": "updateTodo_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "updateTodo": {
            "id": "5",
            "title": "run_$(cat /etc/passwd)_now",
            "completed": false,
            "user": {
              "id": "1",
              "name": "Leanne Graham",
              "email": "Sincere@april.biz"
            }
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:28:36.879170",
      "node_name": "updateTodo_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "updateTodo": {
            "id": "6",
            "title": "../../../../etc/passwd",
            "completed": false,
            "user": {
              "id": "1",
              "name": "Leanne Graham",
              "email": "Sincere@april.biz"
            }
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Path Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "Path injection vulnerability detected - file system access patterns found",
            "evidence": "Response status: 200, Path injection patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Injection Attacks"
        ],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "simple_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:28:57.180774",
      "node_name": "updateTodo_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "updateTodo": {
            "id": "7",
            "title": "<div onclick='steal()'>Click me</div>",
            "completed": false,
            "user": {
              "id": "1",
              "name": "Leanne Graham",
              "email": "Sincere@april.biz"
            }
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "HTML Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "HTML injection vulnerability detected - HTML markup found in response",
            "evidence": "Response status: 200, HTML patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: html_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response returns user-visible content containing raw HTML with an inline event handler (onclick). This is a clear instance of HTML injection: if a client (web UI) inserts this value into the DOM without proper output encoding or sanitization, the embedded JavaScript (steal()) can execute, resulting in XSS. The risk is high because arbitrary markup and script-capable attributes are present in the response. To remediate, ensure server-side validation and/or sanitization of stored content, and always HTML-encode/escape values before inserting into page DOM; additionally apply a restrictive Content Security Policy and consider removing or disallowing executable attributes in user-submitted content.",
            "evidence": "\"title\": \"<div onclick='steal()'>Click me</div>\"",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "html_injection",
              "severity": "HIGH",
              "confidence": 0.8,
              "evidence": "\"title\": \"<div onclick='steal()'>Click me</div>\"",
              "explanation": "The GraphQL response returns user-visible content containing raw HTML with an inline event handler (onclick). This is a clear instance of HTML injection: if a client (web UI) inserts this value into the DOM without proper output encoding or sanitization, the embedded JavaScript (steal()) can execute, resulting in XSS. The risk is high because arbitrary markup and script-capable attributes are present in the response. To remediate, ensure server-side validation and/or sanitization of stored content, and always HTML-encode/escape values before inserting into page DOM; additionally apply a restrictive Content Security Policy and consider removing or disallowing executable attributes in user-submitted content."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:29:06.242284",
      "node_name": "updateTodo_response_7",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:29:15.872450",
      "node_name": "updateTodo_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:29:34.323598",
      "node_name": "updateTodo_response_9",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"types\" on type \"Todo\".",
            "locations": [
              {
                "line": 4,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"updateTodo\" argument \"id\" of type \"ID!\" is required, but it was not provided.",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"updateTodo\" argument \"input\" of type \"UpdateTodoInput!\" is required, but it was not provided.",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Introspection / Information Disclosure",
            "detection": "safe",
            "category": "Injection Attacks",
            "description": "The GraphQL error responses disclose internal schema elements (type names 'Todo', mutation 'updateTodo', and argument types 'ID!' and 'UpdateTodoInput!'). While this is not a successful __schema introspection query, the validation errors leak schema information that can be used to enumerate or probe the API (facilitating reconnaissance). To mitigate, avoid returning detailed schema/error information to unauthenticated users, disable GraphQL introspection in production where appropriate, and return generic error messages.",
            "evidence": "Errors reveal schema details: \"Cannot query field \\\"types\\\" on type \\\"Todo\\\".\" and \"Field \\\"updateTodo\\\" argument \\\"id\\\" of type \\\"ID!\\\" is required...\" and \"Field \\\"updateTodo\\\" argument \\\"input\\\" of type \\\"UpdateTodoInput!\\\" is required...\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Introspection / Information Disclosure",
              "severity": "LOW",
              "confidence": 0.9,
              "evidence": "Errors reveal schema details: \"Cannot query field \\\"types\\\" on type \\\"Todo\\\".\" and \"Field \\\"updateTodo\\\" argument \\\"id\\\" of type \\\"ID!\\\" is required...\" and \"Field \\\"updateTodo\\\" argument \\\"input\\\" of type \\\"UpdateTodoInput!\\\" is required...\"",
              "explanation": "The GraphQL error responses disclose internal schema elements (type names 'Todo', mutation 'updateTodo', and argument types 'ID!' and 'UpdateTodoInput!'). While this is not a successful __schema introspection query, the validation errors leak schema information that can be used to enumerate or probe the API (facilitating reconnaissance). To mitigate, avoid returning detailed schema/error information to unauthenticated users, disable GraphQL introspection in production where appropriate, and return generic error messages."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 1,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:29:48.007657",
      "node_name": "updateTodo_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"tittle\" on type \"Todo\". Did you mean \"title\"?",
            "locations": [
              {
                "line": 5,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: field_suggestions",
            "detection": "safe",
            "category": "Unknown",
            "description": "The GraphQL error response includes an automatic suggestion ('Did you mean \"title\"?') revealing an actual field name from the schema. This is a field_suggestions/information-disclosure issue: it leaks schema details that aid attackers in reconnaissance and crafting more accurate queries. Impact is generally limited to information disclosure (enumeration of fields), so severity is low, but it can be combined with other issues. Recommended mitigations: suppress or sanitize GraphQL validation suggestions in production (return generic error messages), disable/limit introspection in production if appropriate, and implement centralized error handling that does not reveal schema details.",
            "evidence": "Cannot query field \"tittle\" on type \"Todo\". Did you mean \"title\"?",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "field_suggestions",
              "severity": "LOW",
              "confidence": 0.95,
              "evidence": "Cannot query field \"tittle\" on type \"Todo\". Did you mean \"title\"?",
              "explanation": "The GraphQL error response includes an automatic suggestion ('Did you mean \"title\"?') revealing an actual field name from the schema. This is a field_suggestions/information-disclosure issue: it leaks schema details that aid attackers in reconnaissance and crafting more accurate queries. Impact is generally limited to information disclosure (enumeration of fields), so severity is low, but it can be combined with other issues. Recommended mitigations: suppress or sanitize GraphQL validation suggestions in production (return generic error messages), disable/limit introspection in production if appropriate, and implement centralized error handling that does not reveal schema details."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 1,
        "categories": [
          "Unknown"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Information Disclosure",
          "Unknown"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Unknown"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}