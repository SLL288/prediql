{
  "report_timestamp": "2025-10-05T21:59:27.084330",
  "api_url": "https://graphqlzero.almansi.me/api",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.4,
    "simple_detections": 5,
    "llm_detections": 4,
    "consensus_breakdown": {
      "simple_only": 1,
      "both_detected": 4,
      "no_vulnerabilities": 5
    },
    "detection_ratio": 0.8,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 5,
      "llm_potential_detections": 0,
      "potential_consensus_breakdown": {
        "simple_potential_only": 5,
        "no_potential": 5
      },
      "potential_detection_ratio": 0.0
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-05T21:56:46.281546",
      "node_name": "updatePhoto_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "47",
            "title": "Nice Photo'); DROP TABLE users; --",
            "url": "https://example.com/photos/47.jpg"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "SQL Injection (SQLi) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SQL injection vulnerability detected - malicious SQL patterns found in response",
            "evidence": "Response status: 200, SQL patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Injection Attacks"
        ],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "simple_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:56:59.741735",
      "node_name": "updatePhoto_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "48",
            "title": "<script>alert('xss')</script>",
            "thumbnailUrl": "https://example.com/photos/thumbs/48.jpg"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Cross-Site Scripting (XSS) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "XSS injection vulnerability detected - malicious script patterns found in response",
            "evidence": "Response status: 200, XSS patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response for updatePhoto returns the title field containing an unescaped script tag: \"<script>alert('xss')</script>\". This indicates that user-supplied input is being reflected/stored and returned without HTML-encoding or sanitization. If a web client renders this value into the DOM as HTML (or inserts it into the page without proper escaping), it would result in reflected or stored XSS. The finding is flagged as high severity because successful XSS can lead to session theft, account takeover, or other client-side attacks. Note: the actual exploitability depends on how the client handles/render this value; if the frontend always escapes/encodes text nodes, the risk is reduced. Recommended mitigations: validate and sanitize input server-side, HTML-encode output on rendering, adopt a Content Security Policy (CSP), and ensure clients treat returned data as untrusted.",
            "evidence": "\"title\": \"<script>alert('xss')</script>\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "\"title\": \"<script>alert('xss')</script>\"",
              "explanation": "The GraphQL response for updatePhoto returns the title field containing an unescaped script tag: \"<script>alert('xss')</script>\". This indicates that user-supplied input is being reflected/stored and returned without HTML-encoding or sanitization. If a web client renders this value into the DOM as HTML (or inserts it into the page without proper escaping), it would result in reflected or stored XSS. The finding is flagged as high severity because successful XSS can lead to session theft, account takeover, or other client-side attacks. Note: the actual exploitability depends on how the client handles/render this value; if the frontend always escapes/encodes text nodes, the risk is reduced. Recommended mitigations: validate and sanitize input server-side, HTML-encode output on rendering, adopt a Content Security Policy (CSP), and ensure clients treat returned data as untrusted."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:57:29.220689",
      "node_name": "updatePhoto_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "49",
            "url": "http://169.254.169.254/latest/meta-data/iam/security-credentials/",
            "thumbnailUrl": "http://127.0.0.1/admin"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Server-Side Request Forgery (SSRF) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SSRF injection vulnerability detected - internal network access patterns found",
            "evidence": "Response status: 200, SSRF keywords detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: ssrf_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL mutation response (updatePhoto) returns user-controllable URL values that reference link-local/internal addresses (169.254.169.254 is the AWS instance metadata service; 127.0.0.1 is localhost). This strongly indicates the API accepts and stores/echoes external URLs that could be used to cause the server to make requests to internal resources. If the server performs HTTP requests to provided URLs (a common pattern for fetching/validating/processing remote images), an attacker can exploit this to access internal-only services (e.g., instance metadata exposing IAM credentials) or local admin interfaces, a classic SSRF attack. The response does not directly show the server fetched and returned internal data, so there is not absolute proof of request execution; however the presence of these internal addresses is a strong indicator and a high-risk condition that should be tested and mitigated (validate/whitelist external hosts, block link-local/private IPs, enforce URL fetch restrictions, and sanitize/store only canonicalized safe locations).",
            "evidence": "Response contains URL fields pointing to internal addresses: \"url\": \"http://169.254.169.254/latest/meta-data/iam/security-credentials/\", \"thumbnailUrl\": \"http://127.0.0.1/admin\"",
            "confidence": 0.7,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "ssrf_injection",
              "severity": "HIGH",
              "confidence": 0.7,
              "evidence": "Response contains URL fields pointing to internal addresses: \"url\": \"http://169.254.169.254/latest/meta-data/iam/security-credentials/\", \"thumbnailUrl\": \"http://127.0.0.1/admin\"",
              "explanation": "The GraphQL mutation response (updatePhoto) returns user-controllable URL values that reference link-local/internal addresses (169.254.169.254 is the AWS instance metadata service; 127.0.0.1 is localhost). This strongly indicates the API accepts and stores/echoes external URLs that could be used to cause the server to make requests to internal resources. If the server performs HTTP requests to provided URLs (a common pattern for fetching/validating/processing remote images), an attacker can exploit this to access internal-only services (e.g., instance metadata exposing IAM credentials) or local admin interfaces, a classic SSRF attack. The response does not directly show the server fetched and returned internal data, so there is not absolute proof of request execution; however the presence of these internal addresses is a strong indicator and a high-risk condition that should be tested and mitigated (validate/whitelist external hosts, block link-local/private IPs, enforce URL fetch restrictions, and sanitize/store only canonicalized safe locations)."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:57:51.483815",
      "node_name": "updatePhoto_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "50",
            "title": "payload; cat /etc/passwd"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:58:10.544342",
      "node_name": "updatePhoto_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "51",
            "thumbnailUrl": "../../../../../etc/passwd"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Path Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "Path injection vulnerability detected - file system access patterns found",
            "evidence": "Response status: 200, Path injection patterns detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: path_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response for updatePhoto returns a thumbnailUrl that contains a directory traversal path referencing /etc/passwd (\"../../../../../etc/passwd\"). This is a clear indicator of path manipulation or directory traversal: the application is producing or reflecting a filesystem path that escapes expected directories and targets a sensitive system file. That behavior strongly suggests insufficient validation/canonicalization of path inputs (or unsafe concatenation of user-controlled data into file paths), which can allow attackers to read arbitrary files on the host. Impact includes sensitive information disclosure and further local/remote exploitation. Recommend fixing by canonicalizing and validating paths, enforcing an allowlist of accessible directories, using safe APIs that restrict file access, and not reflecting raw filesystem paths to clients.",
            "evidence": "\"thumbnailUrl\": \"../../../../../etc/passwd\"",
            "confidence": 0.85,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "path_injection",
              "severity": "HIGH",
              "confidence": 0.85,
              "evidence": "\"thumbnailUrl\": \"../../../../../etc/passwd\"",
              "explanation": "The GraphQL response for updatePhoto returns a thumbnailUrl that contains a directory traversal path referencing /etc/passwd (\"../../../../../etc/passwd\"). This is a clear indicator of path manipulation or directory traversal: the application is producing or reflecting a filesystem path that escapes expected directories and targets a sensitive system file. That behavior strongly suggests insufficient validation/canonicalization of path inputs (or unsafe concatenation of user-controlled data into file paths), which can allow attackers to read arbitrary files on the host. Impact includes sensitive information disclosure and further local/remote exploitation. Recommend fixing by canonicalizing and validating paths, enforcing an allowlist of accessible directories, using safe APIs that restrict file access, and not reflecting raw filesystem paths to clients."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:58:25.686875",
      "node_name": "updatePhoto_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "updatePhoto": {
            "id": "52",
            "title": "<b>Breaking</b><img src=x onerror=\"alert('html')\">"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "HTML Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "HTML injection vulnerability detected - HTML markup found in response",
            "evidence": "Response status: 200, HTML patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: html_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response returns the title field containing raw HTML and an onerror JavaScript handler: <b> and <img src=x onerror=...>. This is clear HTML injection. If a client renders this value into a web page without proper escaping or sanitization, the onerror handler will execute, resulting in an XSS (client-side) execution. The mutation name updatePhoto suggests this value may be stored and subsequently served to other users (stored XSS), increasing impact. The exploitability depends on how the client displays the field (if the client treats it as HTML and does not escape it, it is exploitable). Recommended mitigations: output-encode/escape user-supplied data, apply an allowlist sanitizer for permitted HTML, validate/normalize inputs on write, and deploy a Content Security Policy to reduce impact.",
            "evidence": "\"title\": \"<b>Breaking</b><img src=x onerror=\\\"alert('html')\\\">\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "html_injection",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "\"title\": \"<b>Breaking</b><img src=x onerror=\\\"alert('html')\\\">\"",
              "explanation": "The GraphQL response returns the title field containing raw HTML and an onerror JavaScript handler: <b> and <img src=x onerror=...>. This is clear HTML injection. If a client renders this value into a web page without proper escaping or sanitization, the onerror handler will execute, resulting in an XSS (client-side) execution. The mutation name updatePhoto suggests this value may be stored and subsequently served to other users (stored XSS), increasing impact. The exploitability depends on how the client displays the field (if the client treats it as HTML and does not escape it, it is exploitable). Recommended mitigations: output-encode/escape user-supplied data, apply an allowlist sanitizer for permitted HTML, validate/normalize inputs on write, and deploy a Content Security Policy to reduce impact."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:58:37.774258",
      "node_name": "updatePhoto_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:58:46.679543",
      "node_name": "updatePhoto_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:59:10.783137",
      "node_name": "updatePhoto_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"updatePhoto\" on type \"Query\".",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T21:59:27.080355",
      "node_name": "updatePhoto_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"updatePhoto\" on type \"Query\".",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}