{
  "report_timestamp": "2025-10-05T16:55:28.526672",
  "api_url": "https://rickandmortyapi.com/graphql",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.0,
    "simple_detections": 0,
    "llm_detections": 5,
    "consensus_breakdown": {
      "llm_only": 5,
      "no_vulnerabilities": 5
    },
    "detection_ratio": Infinity,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 0,
      "llm_potential_detections": 3,
      "potential_consensus_breakdown": {
        "no_potential": 7,
        "llm_potential_only": 3
      },
      "potential_detection_ratio": Infinity
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-05T16:54:48.363317",
      "node_name": "character_response_1",
      "response_status": 200,
      "response_body": {
        "data": {
          "character": null
        },
        "errors": [
          {
            "message": "500: Internal Server Error",
            "locations": [
              {
                "line": 2,
                "column": 3
              }
            ],
            "path": [
              "character"
            ],
            "extensions": {
              "code": "INTERNAL_SERVER_ERROR",
              "response": {
                "url": "http://localhost:8080/api/character/char123%27%20OR%20%27char123%27=%27char123",
                "status": 500,
                "statusText": "Internal Server Error",
                "body": {
                  "error": "Hey! you must provide an id"
                }
              }
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: sql_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The error message indicates that an internal server error occurred when a malicious URL was requested. The URL contains a SQL injection payload, which is a clear sign of a potential vulnerability. This could allow an attacker to inject malicious SQL code into the database, potentially leading to unauthorized data access or manipulation.",
            "evidence": "The error message in the response body contains a URL with a SQL injection payload: 'char123%27%20OR%20%27char123%27=%27char123'. This suggests that the application may be vulnerable to SQL injection attacks.",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "sql_injection",
              "severity": "CRITICAL",
              "confidence": 0.95,
              "evidence": "The error message in the response body contains a URL with a SQL injection payload: 'char123%27%20OR%20%27char123%27=%27char123'. This suggests that the application may be vulnerable to SQL injection attacks.",
              "explanation": "The error message indicates that an internal server error occurred when a malicious URL was requested. The URL contains a SQL injection payload, which is a clear sign of a potential vulnerability. This could allow an attacker to inject malicious SQL code into the database, potentially leading to unauthorized data access or manipulation."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T16:54:51.843150",
      "node_name": "character_response_2",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Unknown argument \"term\" on field \"character\" of type \"Query\".",
            "locations": [
              {
                "line": 2,
                "column": 13
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Cannot query field \"results\" on type \"Character\".",
            "locations": [
              {
                "line": 3,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"character\" argument \"id\" of type \"ID!\" is required, but it was not provided.",
            "locations": [
              {
                "line": 2,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T16:54:56.267638",
      "node_name": "character_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "character": {
            "id": null,
            "name": null
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: SSRF",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL API is not properly validating or sanitizing the user input for the 'character' query. This allows an attacker to inject internal network addresses into the 'id' field, potentially leading to SSRF attacks. Specifically, the absence of validation or sanitization on the 'id' field creates an opportunity for an attacker to inject a valid internal network address, allowing them to potentially access internal resources or data that would not be accessible otherwise.",
            "evidence": "The character query is not filtering the 'id' field, which could be used to make internal network requests or access the file system. In this case, the 'id' field is set to null, but if it were set to a valid internal network address (e.g., the GraphQL server's IP), it could be used to make requests to internal resources.",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "SSRF",
              "severity": "HIGH",
              "confidence": 0.9,
              "evidence": "The character query is not filtering the 'id' field, which could be used to make internal network requests or access the file system. In this case, the 'id' field is set to null, but if it were set to a valid internal network address (e.g., the GraphQL server's IP), it could be used to make requests to internal resources.",
              "explanation": "The GraphQL API is not properly validating or sanitizing the user input for the 'character' query. This allows an attacker to inject internal network addresses into the 'id' field, potentially leading to SSRF attacks. Specifically, the absence of validation or sanitization on the 'id' field creates an opportunity for an attacker to inject a valid internal network address, allowing them to potentially access internal resources or data that would not be accessible otherwise."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T16:54:59.204248",
      "node_name": "character_response_4",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"air_date\" on type \"Character\".",
            "locations": [
              {
                "line": 3,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"episode\" of type \"[Episode]!\" must have a selection of subfields. Did you mean \"episode { ... }\"?",
            "locations": [
              {
                "line": 4,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T16:55:05.021665",
      "node_name": "character_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "character": null
        },
        "errors": [
          {
            "message": "500: Internal Server Error",
            "locations": [
              {
                "line": 2,
                "column": 3
              }
            ],
            "path": [
              "character"
            ],
            "extensions": {
              "code": "INTERNAL_SERVER_ERROR",
              "response": {
                "url": "http://localhost:8080/api/character/long_id_value%20that%20breaks%20field%20resolution%201%201",
                "status": 500,
                "statusText": "Internal Server Error",
                "body": {
                  "error": "Hey! you must provide an id"
                }
              }
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Path Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The presence of the '%20' transformation in the error message URL may indicate a path injection vulnerability, suggesting possible directory traversal or path manipulation. Further investigation is required to determine the exact nature and extent of this potential vulnerability.",
            "evidence": "The error message contains a URL with a path that contains a '%20' space character transformation: \"http://localhost:8080/api/character/long_id_value%20that%20breaks%20field%20resolution%201%201\"",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Path Injection",
              "severity": "MEDIUM",
              "confidence": 0.8,
              "evidence": "The error message contains a URL with a path that contains a '%20' space character transformation: \"http://localhost:8080/api/character/long_id_value%20that%20breaks%20field%20resolution%201%201\"",
              "explanation": "The presence of the '%20' transformation in the error message URL may indicate a path injection vulnerability, suggesting possible directory traversal or path manipulation. Further investigation is required to determine the exact nature and extent of this potential vulnerability."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T16:55:07.044821",
      "node_name": "character_response_6",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"air_date\" on type \"Character\".",
            "locations": [
              {
                "line": 3,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"episode\" of type \"[Episode]!\" must have a selection of subfields. Did you mean \"episode { ... }\"?",
            "locations": [
              {
                "line": 4,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T16:55:12.595803",
      "node_name": "character_response_7",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T16:55:20.187260",
      "node_name": "character_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-05T16:55:25.576694",
      "node_name": "character_response_9",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"schema\" on type \"Character\".",
            "locations": [
              {
                "line": 3,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"character\" argument \"id\" of type \"ID!\" is required, but it was not provided.",
            "locations": [
              {
                "line": 2,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Information Disclosure",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The GraphQL response contains an error message that mentions the \"schema\" field on the \"Character\" type. This is a clear indication of schema introspection vulnerability. The error message does not contain any identifiable information, but the presence of schema details in the response makes the API vulnerable to information disclosure. An attacker might be able to exploit this by making specially crafted queries to gather information about the schema and its fields, potentially leading to a better understanding of the GraphQL API's structure and functionality. However, the vulnerability is considered medium-severity because it does not directly lead to data exposure or a significant increase in an attacker's privileges.",
            "evidence": "Schema introspection field \"schema\" is exposed in the response, and error messages are revealing GraphQL schema details.",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Information Disclosure",
              "severity": "MEDIUM",
              "confidence": 0.9,
              "evidence": "Schema introspection field \"schema\" is exposed in the response, and error messages are revealing GraphQL schema details.",
              "explanation": "The GraphQL response contains an error message that mentions the \"schema\" field on the \"Character\" type. This is a clear indication of schema introspection vulnerability. The error message does not contain any identifiable information, but the presence of schema details in the response makes the API vulnerable to information disclosure. An attacker might be able to exploit this by making specially crafted queries to gather information about the schema and its fields, potentially leading to a better understanding of the GraphQL API's structure and functionality. However, the vulnerability is considered medium-severity because it does not directly lead to data exposure or a significant increase in an attacker's privileges."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-05T16:55:28.525218",
      "node_name": "character_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Unknown argument \"term\" on field \"character\" of type \"Query\".",
            "locations": [
              {
                "line": 2,
                "column": 13
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Cannot query field \"results\" on type \"Character\".",
            "locations": [
              {
                "line": 3,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          },
          {
            "message": "Field \"character\" argument \"id\" of type \"ID!\" is required, but it was not provided.",
            "locations": [
              {
                "line": 2,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Information Disclosure",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The error message 'Unknown argument \"term\" on field \"character\" of type \"Query\".' indicates that the GraphQL schema is being disclosed to the client, which can be a field suggestions vulnerability. This can allow an attacker to Infer field names and types, potentially leading to them guessing other fields and types.",
            "evidence": "The response contains a field suggestions-related vulnerability as the error message 'Unknown argument \"term\" on field \"character\" of type \"Query\".' suggests that the server is disclosing sensitive information about the available fields and types.",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Information Disclosure",
              "severity": "MEDIUM",
              "confidence": 0.8,
              "evidence": "The response contains a field suggestions-related vulnerability as the error message 'Unknown argument \"term\" on field \"character\" of type \"Query\".' suggests that the server is disclosing sensitive information about the available fields and types.",
              "explanation": "The error message 'Unknown argument \"term\" on field \"character\" of type \"Query\".' indicates that the GraphQL schema is being disclosed to the client, which can be a field suggestions vulnerability. This can allow an attacker to Infer field names and types, potentially leading to them guessing other fields and types."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}