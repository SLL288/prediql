{
  "report_timestamp": "2025-09-29T08:43:53.731245",
  "api_url": "https://portal.ehri-project.eu/api/graphql",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.0,
    "simple_detections": 1,
    "llm_detections": 2,
    "consensus_breakdown": {
      "no_vulnerabilities": 8,
      "both_detected": 1,
      "llm_only": 1
    },
    "detection_ratio": 2.0,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 0,
      "llm_potential_detections": 1,
      "potential_consensus_breakdown": {
        "no_potential": 9,
        "llm_potential_only": 1
      },
      "potential_detection_ratio": Infinity
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-09-29T08:43:41.451584",
      "node_name": "Link_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "Link": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-09-29T08:43:42.394407",
      "node_name": "Link_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "Link": {
            "id": "28539296-c897-11e4-840b-132830f5faa0",
            "description": "",
            "annotations": []
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-09-29T08:43:43.499619",
      "node_name": "Link_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "Link": {
            "id": "28539296-c897-11e4-840b-132830f5faa0",
            "field": null
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-09-29T08:43:44.491668",
      "node_name": "Link_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "Link": {
            "id": "28539296-c897-11e4-840b-132830f5faa0",
            "description": ""
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-09-29T08:43:45.312948",
      "node_name": "Link_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "Link": {
            "id": "28539296-c897-11e4-840b-132830f5faa0",
            "description": ""
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-09-29T08:43:46.367842",
      "node_name": "Link_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "Link": {
            "id": "28539296-c897-11e4-840b-132830f5faa0",
            "description": "",
            "annotations": []
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-09-29T08:43:48.032496",
      "node_name": "Link_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-09-29T08:43:49.895600",
      "node_name": "Link_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-09-29T08:43:51.939085",
      "node_name": "Link_response_10",
      "response_status": 200,
      "response_body": {
        "data": {
          "Link": {
            "id": "28539296-c897-11e4-840b-132830f5faa0",
            "__typename": "Link"
          },
          "__schema": {
            "types": [
              {
                "name": "AccessPoint",
                "kind": "OBJECT"
              },
              {
                "name": "AccessPointType",
                "kind": "ENUM"
              },
              {
                "name": "Address",
                "kind": "OBJECT"
              },
              {
                "name": "Annotatable",
                "kind": "INTERFACE"
              },
              {
                "name": "Annotation",
                "kind": "OBJECT"
              },
              {
                "name": "AnnotationEdge",
                "kind": "OBJECT"
              },
              {
                "name": "AuthoritativeSet",
                "kind": "OBJECT"
              },
              {
                "name": "AuthoritativeSetEdge",
                "kind": "OBJECT"
              },
              {
                "name": "BigDecimal",
                "kind": "SCALAR"
              },
              {
                "name": "Boolean",
                "kind": "SCALAR"
              },
              {
                "name": "Country",
                "kind": "OBJECT"
              },
              {
                "name": "CountryEdge",
                "kind": "OBJECT"
              },
              {
                "name": "Cursor",
                "kind": "SCALAR"
              },
              {
                "name": "CvocConcept",
                "kind": "OBJECT"
              },
              {
                "name": "CvocConceptDescription",
                "kind": "OBJECT"
              },
              {
                "name": "CvocConceptEdge",
                "kind": "OBJECT"
              },
              {
                "name": "CvocVocabulary",
                "kind": "OBJECT"
              },
              {
                "name": "CvocVocabularyEdge",
                "kind": "OBJECT"
              },
              {
                "name": "DatePeriod",
                "kind": "OBJECT"
              },
              {
                "name": "Described",
                "kind": "INTERFACE"
              },
              {
                "name": "Description",
                "kind": "INTERFACE"
              },
              {
                "name": "DocumentaryUnit",
                "kind": "OBJECT"
              },
              {
                "name": "DocumentaryUnitDescription",
                "kind": "OBJECT"
              },
              {
                "name": "DocumentaryUnitEdge",
                "kind": "OBJECT"
              },
              {
                "name": "Entity",
                "kind": "INTERFACE"
              },
              {
                "name": "HistoricalAgent",
                "kind": "OBJECT"
              },
              {
                "name": "HistoricalAgentDescription",
                "kind": "OBJECT"
              },
              {
                "name": "HistoricalAgentEdge",
                "kind": "OBJECT"
              },
              {
                "name": "ID",
                "kind": "SCALAR"
              },
              {
                "name": "Int",
                "kind": "SCALAR"
              },
              {
                "name": "Link",
                "kind": "OBJECT"
              },
              {
                "name": "LinkEdge",
                "kind": "OBJECT"
              },
              {
                "name": "LinkType",
                "kind": "ENUM"
              },
              {
                "name": "Linkable",
                "kind": "INTERFACE"
              },
              {
                "name": "Relationship",
                "kind": "OBJECT"
              },
              {
                "name": "Repository",
                "kind": "OBJECT"
              },
              {
                "name": "RepositoryDescription",
                "kind": "OBJECT"
              },
              {
                "name": "RepositoryEdge",
                "kind": "OBJECT"
              },
              {
                "name": "Root",
                "kind": "OBJECT"
              },
              {
                "name": "String",
                "kind": "SCALAR"
              },
              {
                "name": "SystemEvent",
                "kind": "OBJECT"
              },
              {
                "name": "Temporal",
                "kind": "INTERFACE"
              },
              {
                "name": "TemporalDescription",
                "kind": "INTERFACE"
              },
              {
                "name": "__Directive",
                "kind": "OBJECT"
              },
              {
                "name": "__DirectiveLocation",
                "kind": "ENUM"
              },
              {
                "name": "__EnumValue",
                "kind": "OBJECT"
              },
              {
                "name": "__Field",
                "kind": "OBJECT"
              },
              {
                "name": "__InputValue",
                "kind": "OBJECT"
              },
              {
                "name": "__Schema",
                "kind": "OBJECT"
              },
              {
                "name": "__Type",
                "kind": "OBJECT"
              },
              {
                "name": "__TypeKind",
                "kind": "ENUM"
              },
              {
                "name": "annotations",
                "kind": "OBJECT"
              },
              {
                "name": "authoritativeSets",
                "kind": "OBJECT"
              },
              {
                "name": "concepts",
                "kind": "OBJECT"
              },
              {
                "name": "countries",
                "kind": "OBJECT"
              },
              {
                "name": "documentaryUnits",
                "kind": "OBJECT"
              },
              {
                "name": "historicalAgents",
                "kind": "OBJECT"
              },
              {
                "name": "links",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoAnnotation",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoAuthoritativeSet",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoCountry",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoCvocConcept",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoCvocVocabulary",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoDocumentaryUnit",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoHistoricalAgent",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoLink",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoRepository",
                "kind": "OBJECT"
              },
              {
                "name": "repositories",
                "kind": "OBJECT"
              },
              {
                "name": "vocabularies",
                "kind": "OBJECT"
              }
            ]
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Introspection Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "GraphQL introspection enabled - potential information disclosure",
            "evidence": "Found __schema in response data - introspection queries are allowed"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Information Disclosure",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The GraphQL response explicitly includes the '__schema' field, which is part of the GraphQL introspection system. This indicates that introspection is enabled on this GraphQL endpoint. While introspection itself is a standard GraphQL feature, its exposure in a production environment, especially without proper authentication or authorization, can lead to information disclosure. An attacker can use this information to understand the entire API's structure, including types, fields, arguments, and queries/mutations. This detailed schema information can significantly aid in crafting more targeted attacks, such as identifying potential data points for enumeration, understanding data relationships, or preparing for other exploitation attempts like injection attacks or access control bypasses by knowing all available operations. The severity is considered MEDIUM because it doesn't directly expose sensitive data, but it greatly facilitates further attacks.",
            "evidence": "The response body contains a '__schema' field within the 'data' object, which exposes a list of all available 'types' (e.g., 'AccessPoint', 'Address', 'Annotation', 'Link', 'Repository', '__Directive', '__Schema', etc.), their 'name', and 'kind' (e.g., 'OBJECT', 'ENUM', 'SCALAR', 'INTERFACE').",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Information Disclosure",
              "severity": "MEDIUM",
              "confidence": 0.9,
              "evidence": "The response body contains a '__schema' field within the 'data' object, which exposes a list of all available 'types' (e.g., 'AccessPoint', 'Address', 'Annotation', 'Link', 'Repository', '__Directive', '__Schema', etc.), their 'name', and 'kind' (e.g., 'OBJECT', 'ENUM', 'SCALAR', 'INTERFACE').",
              "explanation": "The GraphQL response explicitly includes the '__schema' field, which is part of the GraphQL introspection system. This indicates that introspection is enabled on this GraphQL endpoint. While introspection itself is a standard GraphQL feature, its exposure in a production environment, especially without proper authentication or authorization, can lead to information disclosure. An attacker can use this information to understand the entire API's structure, including types, fields, arguments, and queries/mutations. This detailed schema information can significantly aid in crafting more targeted attacks, such as identifying potential data points for enumeration, understanding data relationships, or preparing for other exploitation attempts like injection attacks or access control bypasses by knowing all available operations. The severity is considered MEDIUM because it doesn't directly expose sensitive data, but it greatly facilitates further attacks."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-09-29T08:43:53.728630",
      "node_name": "Link_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (FieldUndefined@[Link/typ]) : Field 'typ' in type 'Link' is undefined",
            "locations": [
              {
                "line": 5,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Link/descripption]) : Field 'descripption' in type 'Link' is undefined",
            "locations": [
              {
                "line": 6,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Link/linType]) : Field 'linType' in type 'Link' is undefined",
            "locations": [
              {
                "line": 7,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: field_suggestions",
            "detection": "safe",
            "category": "Unknown",
            "description": "The GraphQL response explicitly states 'Field 'typ' in type 'Link' is undefined', 'Field 'descripption' in type 'Link' is undefined', and 'Field 'linType' in type 'Link' is undefined'. While these messages do not directly suggest valid fields, the nature of these validation errors (typos often lead to such errors) in GraphQL APIs frequently indicates that the API is providing 'field suggestions' in the background or could be coerced into doing so. This type of error message, especially when combined with a mispelling like 'descripption' which is a common vulnerability, allows attackers to enumerate the API schema by trial and error, guessing field names and receiving feedback (or suggested corrections) from the server. This constitutes an information disclosure vulnerability, specifically 'field suggestions'.",
            "evidence": "Validation error (FieldUndefined@[Link/typ]) : Field 'typ' in type 'Link' is undefined, Validation error (FieldUndefined@[Link/descripption]) : Field 'descripption' in type 'Link' is undefined, Validation error (FieldUndefined@[Link/linType]) : Field 'linType' in type 'Link' is undefined",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "field_suggestions",
              "severity": "LOW",
              "confidence": 0.8,
              "evidence": "Validation error (FieldUndefined@[Link/typ]) : Field 'typ' in type 'Link' is undefined, Validation error (FieldUndefined@[Link/descripption]) : Field 'descripption' in type 'Link' is undefined, Validation error (FieldUndefined@[Link/linType]) : Field 'linType' in type 'Link' is undefined",
              "explanation": "The GraphQL response explicitly states 'Field 'typ' in type 'Link' is undefined', 'Field 'descripption' in type 'Link' is undefined', and 'Field 'linType' in type 'Link' is undefined'. While these messages do not directly suggest valid fields, the nature of these validation errors (typos often lead to such errors) in GraphQL APIs frequently indicates that the API is providing 'field suggestions' in the background or could be coerced into doing so. This type of error message, especially when combined with a mispelling like 'descripption' which is a common vulnerability, allows attackers to enumerate the API schema by trial and error, guessing field names and receiving feedback (or suggested corrections) from the server. This constitutes an information disclosure vulnerability, specifically 'field suggestions'."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 1,
        "categories": [
          "Unknown"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Unknown"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Unknown"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}