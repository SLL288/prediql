{
  "report_timestamp": "2025-10-06T00:40:52.314957",
  "api_url": "https://portal.ehri-project.eu/api/graphql",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.0,
    "simple_detections": 0,
    "llm_detections": 2,
    "consensus_breakdown": {
      "no_vulnerabilities": 8,
      "llm_only": 2
    },
    "detection_ratio": Infinity,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 0,
      "llm_potential_detections": 0,
      "potential_consensus_breakdown": {
        "no_potential": 10
      },
      "potential_detection_ratio": Infinity
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-06T00:40:33.913505",
      "node_name": "HistoricalAgent_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "HistoricalAgent": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:40:35.394473",
      "node_name": "HistoricalAgent_response_3",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (SubselectionNotAllowed@[HistoricalAgent/description/source]) : Subselection not allowed on leaf type 'String' of field 'source'",
            "locations": [
              {
                "line": 8,
                "column": 7
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (UnknownArgument@[HistoricalAgent/description/source]) : Unknown field argument 'lang'",
            "locations": [
              {
                "line": 8,
                "column": 14
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:40:36.896867",
      "node_name": "HistoricalAgent_response_4",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (SubselectionNotAllowed@[HistoricalAgent/description/source]) : Subselection not allowed on leaf type 'String' of field 'source'",
            "locations": [
              {
                "line": 10,
                "column": 7
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (UnknownArgument@[HistoricalAgent/description/source]) : Unknown field argument 'url'",
            "locations": [
              {
                "line": 10,
                "column": 14
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldsConflict@[HistoricalAgent/description]) : 'source' : fields have different arguments",
            "locations": [
              {
                "line": 6,
                "column": 7
              },
              {
                "line": 10,
                "column": 7
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:40:38.509449",
      "node_name": "HistoricalAgent_response_5",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (SubselectionNotAllowed@[HistoricalAgent/description/languageCode]) : Subselection not allowed on leaf type 'String' of field 'languageCode'",
            "locations": [
              {
                "line": 8,
                "column": 7
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (UnknownArgument@[HistoricalAgent/description/languageCode]) : Unknown field argument 'code'",
            "locations": [
              {
                "line": 8,
                "column": 20
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:40:40.216949",
      "node_name": "HistoricalAgent_response_6",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (SubselectionNotAllowed@[HistoricalAgent/description/source]) : Subselection not allowed on leaf type 'String' of field 'source'",
            "locations": [
              {
                "line": 7,
                "column": 7
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (UnknownArgument@[HistoricalAgent/description/source]) : Unknown field argument 'path'",
            "locations": [
              {
                "line": 7,
                "column": 14
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldsConflict@[HistoricalAgent/description]) : 'source' : fields have different arguments",
            "locations": [
              {
                "line": 6,
                "column": 7
              },
              {
                "line": 7,
                "column": 7
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:40:42.086382",
      "node_name": "HistoricalAgent_response_7",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (UnknownArgument@[HistoricalAgent/description/name]) : Unknown field argument 'detail'",
            "locations": [
              {
                "line": 6,
                "column": 12
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:40:44.444692",
      "node_name": "HistoricalAgent_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:40:47.168587",
      "node_name": "HistoricalAgent_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:40:49.548890",
      "node_name": "HistoricalAgent_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (MissingFieldArgument@[HistoricalAgent]) : Missing field argument 'id'",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[HistoricalAgent/types]) : Field 'types' in type 'HistoricalAgent' is undefined",
            "locations": [
              {
                "line": 4,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Information Disclosure",
            "detection": "safe",
            "category": "Injection Attacks",
            "description": "The GraphQL response explicitly discloses schema-related information in the error messages. Specifically, it reveals the existence of a type named 'HistoricalAgent', a field 'types' within 'HistoricalAgent', and indicates that an 'id' argument is expected for 'HistoricalAgent'. While not a full schema dump, these error messages provide valuable clues about the API's structure and available types/fields, which can be leveraged by an attacker for further introspection or crafting malicious queries. This constitutes information disclosure, as an attacker can infer parts of the schema without having explicit permission to introspect it.",
            "evidence": "Response Body: {\n  \"errors\": [\n    {\n      \"message\": \"Validation error (MissingFieldArgument@[HistoricalAgent]) : Missing field argument 'id'\",\n      \"locations\": [\n        {\n          \"line\": 3,\n          \"column\": 3\n        }\n      ],\n      \"extensions\": {\n        \"classification\": \"ValidationError\"\n      }\n    },\n    {\n      \"message\": \"Validation error (FieldUndefined@[HistoricalAgent/types]) : Field 'types' in type 'HistoricalAgent' is undefined\",\n      \"locations\": [\n        {\n          \"line\": 4,\n          \"column\": 5\n        }\n      ],\n      \"extensions\": {\n        \"classification\": \"ValidationError\"\n      }\n    }\n  ]\n}",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Information Disclosure",
              "severity": "LOW",
              "confidence": 0.8,
              "evidence": "Response Body: {\n  \"errors\": [\n    {\n      \"message\": \"Validation error (MissingFieldArgument@[HistoricalAgent]) : Missing field argument 'id'\",\n      \"locations\": [\n        {\n          \"line\": 3,\n          \"column\": 3\n        }\n      ],\n      \"extensions\": {\n        \"classification\": \"ValidationError\"\n      }\n    },\n    {\n      \"message\": \"Validation error (FieldUndefined@[HistoricalAgent/types]) : Field 'types' in type 'HistoricalAgent' is undefined\",\n      \"locations\": [\n        {\n          \"line\": 4,\n          \"column\": 5\n        }\n      ],\n      \"extensions\": {\n        \"classification\": \"ValidationError\"\n      }\n    }\n  ]\n}",
              "explanation": "The GraphQL response explicitly discloses schema-related information in the error messages. Specifically, it reveals the existence of a type named 'HistoricalAgent', a field 'types' within 'HistoricalAgent', and indicates that an 'id' argument is expected for 'HistoricalAgent'. While not a full schema dump, these error messages provide valuable clues about the API's structure and available types/fields, which can be leveraged by an attacker for further introspection or crafting malicious queries. This constitutes information disclosure, as an attacker can infer parts of the schema without having explicit permission to introspect it."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 1,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-06T00:40:52.313239",
      "node_name": "HistoricalAgent_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (FieldUndefined@[HistoricalAgent/id_field_not_exist]) : Field 'id_field_not_exist' in type 'HistoricalAgent' is undefined",
            "locations": [
              {
                "line": 4,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[HistoricalAgent/descriptionss]) : Field 'descriptionss' in type 'HistoricalAgent' is undefined",
            "locations": [
              {
                "line": 6,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[HistoricalAgent/links/type_wrong]) : Field 'type_wrong' in type 'Link' is undefined",
            "locations": [
              {
                "line": 9,
                "column": 7
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Information Disclosure",
            "detection": "safe",
            "category": "Injection Attacks",
            "description": "This GraphQL response exhibits a 'field_suggestions' vulnerability, a type of Information Disclosure. While not explicitly suggesting alternative field names, the detailed error messages pinpoint exactly which fields within specific GraphQL types (e.g., 'HistoricalAgent', 'Link') are undefined. This level of detail in error messages can be leveraged by an attacker to probe and understand the underlying GraphQL schema without proper introspection queries. By sending queries with slightly incorrect field names, an attacker can enumerate valid fields, their types, and relationships. This information is valuable for mapping out the API and identifying potential targets for further attacks, even if no explicit suggestions are given. The vulnerability lies in the verbosity of the error messages, which aid in schema discovery.",
            "evidence": "The error messages 'Field 'id_field_not_exist' in type 'HistoricalAgent' is undefined', 'Field 'descriptionss' in type 'HistoricalAgent' is undefined', and 'Field 'type_wrong' in type 'Link' is undefined' indicate that the server is providing detailed feedback about non-existent fields. This implies direct exposure of field names and their associated types within the GraphQL schema.",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Information Disclosure",
              "severity": "LOW",
              "confidence": 0.8,
              "evidence": "The error messages 'Field 'id_field_not_exist' in type 'HistoricalAgent' is undefined', 'Field 'descriptionss' in type 'HistoricalAgent' is undefined', and 'Field 'type_wrong' in type 'Link' is undefined' indicate that the server is providing detailed feedback about non-existent fields. This implies direct exposure of field names and their associated types within the GraphQL schema.",
              "explanation": "This GraphQL response exhibits a 'field_suggestions' vulnerability, a type of Information Disclosure. While not explicitly suggesting alternative field names, the detailed error messages pinpoint exactly which fields within specific GraphQL types (e.g., 'HistoricalAgent', 'Link') are undefined. This level of detail in error messages can be leveraged by an attacker to probe and understand the underlying GraphQL schema without proper introspection queries. By sending queries with slightly incorrect field names, an attacker can enumerate valid fields, their types, and relationships. This information is valuable for mapping out the API and identifying potential targets for further attacks, even if no explicit suggestions are given. The vulnerability lies in the verbosity of the error messages, which aid in schema discovery."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 1,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}