{
  "report_timestamp": "2025-10-03T01:35:08.371388",
  "api_url": "https://portal.ehri-project.eu/api/graphql",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.0,
    "simple_detections": 1,
    "llm_detections": 2,
    "consensus_breakdown": {
      "no_vulnerabilities": 8,
      "both_detected": 1,
      "llm_only": 1
    },
    "detection_ratio": 2.0,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 0,
      "llm_potential_detections": 2,
      "potential_consensus_breakdown": {
        "no_potential": 8,
        "llm_potential_only": 2
      },
      "potential_detection_ratio": Infinity
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-03T01:33:21.141981",
      "node_name": "Annotation_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "Annotation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:33:36.189733",
      "node_name": "Annotation_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "Annotation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:33:44.863424",
      "node_name": "Annotation_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "Annotation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:34:00.916542",
      "node_name": "Annotation_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "Annotation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:34:10.569256",
      "node_name": "Annotation_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "Annotation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:34:18.443356",
      "node_name": "Annotation_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "Annotation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:34:28.182884",
      "node_name": "Annotation_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:34:37.903273",
      "node_name": "Annotation_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:34:50.647204",
      "node_name": "Annotation_response_10",
      "response_status": 200,
      "response_body": {
        "data": {
          "Annotation": null,
          "__schema": {
            "types": [
              {
                "name": "AccessPoint",
                "kind": "OBJECT"
              },
              {
                "name": "AccessPointType",
                "kind": "ENUM"
              },
              {
                "name": "Address",
                "kind": "OBJECT"
              },
              {
                "name": "Annotatable",
                "kind": "INTERFACE"
              },
              {
                "name": "Annotation",
                "kind": "OBJECT"
              },
              {
                "name": "AnnotationEdge",
                "kind": "OBJECT"
              },
              {
                "name": "AuthoritativeSet",
                "kind": "OBJECT"
              },
              {
                "name": "AuthoritativeSetEdge",
                "kind": "OBJECT"
              },
              {
                "name": "BigDecimal",
                "kind": "SCALAR"
              },
              {
                "name": "Boolean",
                "kind": "SCALAR"
              },
              {
                "name": "Country",
                "kind": "OBJECT"
              },
              {
                "name": "CountryEdge",
                "kind": "OBJECT"
              },
              {
                "name": "Cursor",
                "kind": "SCALAR"
              },
              {
                "name": "CvocConcept",
                "kind": "OBJECT"
              },
              {
                "name": "CvocConceptDescription",
                "kind": "OBJECT"
              },
              {
                "name": "CvocConceptEdge",
                "kind": "OBJECT"
              },
              {
                "name": "CvocVocabulary",
                "kind": "OBJECT"
              },
              {
                "name": "CvocVocabularyEdge",
                "kind": "OBJECT"
              },
              {
                "name": "DatePeriod",
                "kind": "OBJECT"
              },
              {
                "name": "Described",
                "kind": "INTERFACE"
              },
              {
                "name": "Description",
                "kind": "INTERFACE"
              },
              {
                "name": "DocumentaryUnit",
                "kind": "OBJECT"
              },
              {
                "name": "DocumentaryUnitDescription",
                "kind": "OBJECT"
              },
              {
                "name": "DocumentaryUnitEdge",
                "kind": "OBJECT"
              },
              {
                "name": "Entity",
                "kind": "INTERFACE"
              },
              {
                "name": "HistoricalAgent",
                "kind": "OBJECT"
              },
              {
                "name": "HistoricalAgentDescription",
                "kind": "OBJECT"
              },
              {
                "name": "HistoricalAgentEdge",
                "kind": "OBJECT"
              },
              {
                "name": "ID",
                "kind": "SCALAR"
              },
              {
                "name": "Int",
                "kind": "SCALAR"
              },
              {
                "name": "Link",
                "kind": "OBJECT"
              },
              {
                "name": "LinkEdge",
                "kind": "OBJECT"
              },
              {
                "name": "LinkType",
                "kind": "ENUM"
              },
              {
                "name": "Linkable",
                "kind": "INTERFACE"
              },
              {
                "name": "Relationship",
                "kind": "OBJECT"
              },
              {
                "name": "Repository",
                "kind": "OBJECT"
              },
              {
                "name": "RepositoryDescription",
                "kind": "OBJECT"
              },
              {
                "name": "RepositoryEdge",
                "kind": "OBJECT"
              },
              {
                "name": "Root",
                "kind": "OBJECT"
              },
              {
                "name": "String",
                "kind": "SCALAR"
              },
              {
                "name": "SystemEvent",
                "kind": "OBJECT"
              },
              {
                "name": "Temporal",
                "kind": "INTERFACE"
              },
              {
                "name": "TemporalDescription",
                "kind": "INTERFACE"
              },
              {
                "name": "__Directive",
                "kind": "OBJECT"
              },
              {
                "name": "__DirectiveLocation",
                "kind": "ENUM"
              },
              {
                "name": "__EnumValue",
                "kind": "OBJECT"
              },
              {
                "name": "__Field",
                "kind": "OBJECT"
              },
              {
                "name": "__InputValue",
                "kind": "OBJECT"
              },
              {
                "name": "__Schema",
                "kind": "OBJECT"
              },
              {
                "name": "__Type",
                "kind": "OBJECT"
              },
              {
                "name": "__TypeKind",
                "kind": "ENUM"
              },
              {
                "name": "annotations",
                "kind": "OBJECT"
              },
              {
                "name": "authoritativeSets",
                "kind": "OBJECT"
              },
              {
                "name": "concepts",
                "kind": "OBJECT"
              },
              {
                "name": "countries",
                "kind": "OBJECT"
              },
              {
                "name": "documentaryUnits",
                "kind": "OBJECT"
              },
              {
                "name": "historicalAgents",
                "kind": "OBJECT"
              },
              {
                "name": "links",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoAnnotation",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoAuthoritativeSet",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoCountry",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoCvocConcept",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoCvocVocabulary",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoDocumentaryUnit",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoHistoricalAgent",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoLink",
                "kind": "OBJECT"
              },
              {
                "name": "pageInfoRepository",
                "kind": "OBJECT"
              },
              {
                "name": "repositories",
                "kind": "OBJECT"
              },
              {
                "name": "vocabularies",
                "kind": "OBJECT"
              }
            ]
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Introspection Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "GraphQL introspection enabled - potential information disclosure",
            "evidence": "Found __schema in response data - introspection queries are allowed"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Introspection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The GraphQL response returns an active introspection result (presence of the \"__schema\" object and a full \"types\" list), which confirms that schema introspection is enabled and accessible. This discloses the API schema, type and field names, and internal objects — information that an attacker can use to map the API, discover sensitive fields/endpoints, and craft targeted queries or further attacks. While introspection is a standard GraphQL feature, exposing it in production without proper access controls increases information disclosure risk. Recommended mitigations: disable or restrict introspection in production, enforce authentication/authorization on introspection endpoints, or filter/obfuscate sensitive schema elements.",
            "evidence": "Response body contains a top-level \"__schema\" object with a \"types\" array exposing schema types (examples: \"__Schema\", \"__Type\", \"__Directive\", plus application types like \"DocumentaryUnit\", \"Repository\", \"Annotation\").",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Introspection",
              "severity": "MEDIUM",
              "confidence": 0.95,
              "evidence": "Response body contains a top-level \"__schema\" object with a \"types\" array exposing schema types (examples: \"__Schema\", \"__Type\", \"__Directive\", plus application types like \"DocumentaryUnit\", \"Repository\", \"Annotation\").",
              "explanation": "The GraphQL response returns an active introspection result (presence of the \"__schema\" object and a full \"types\" list), which confirms that schema introspection is enabled and accessible. This discloses the API schema, type and field names, and internal objects — information that an attacker can use to map the API, discover sensitive fields/endpoints, and craft targeted queries or further attacks. While introspection is a standard GraphQL feature, exposing it in production without proper access controls increases information disclosure risk. Recommended mitigations: disable or restrict introspection in production, enforce authentication/authorization on introspection endpoints, or filter/obfuscate sensitive schema elements."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:35:08.367727",
      "node_name": "Annotation_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (FieldUndefined@[Annotation/byy]) : Field 'byy' in type 'Annotation' is undefined",
            "locations": [
              {
                "line": 5,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Annotation/boddy]) : Field 'boddy' in type 'Annotation' is undefined",
            "locations": [
              {
                "line": 6,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: field_suggestions",
            "detection": "potential",
            "category": "Unknown",
            "description": "The GraphQL response returns explicit validation errors that include the GraphQL type name ('Annotation') and the invalid field names. This leaks schema-related information (type and field context) which can help an attacker enumerate the schema and craft targeted queries. While the errors do not directly expose sensitive data or suggest correct field names, they still constitute field-suggestions/information-disclosure by revealing internal schema structure. Recommend returning generic error messages or disabling detailed validation error output in production, and consider using error masking or logging detailed errors server-side only.",
            "evidence": "Error messages: \"Field 'byy' in type 'Annotation' is undefined\" and \"Field 'boddy' in type 'Annotation' is undefined\" (ValidationError)",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "field_suggestions",
              "severity": "MEDIUM",
              "confidence": 0.9,
              "evidence": "Error messages: \"Field 'byy' in type 'Annotation' is undefined\" and \"Field 'boddy' in type 'Annotation' is undefined\" (ValidationError)",
              "explanation": "The GraphQL response returns explicit validation errors that include the GraphQL type name ('Annotation') and the invalid field names. This leaks schema-related information (type and field context) which can help an attacker enumerate the schema and craft targeted queries. While the errors do not directly expose sensitive data or suggest correct field names, they still constitute field-suggestions/information-disclosure by revealing internal schema structure. Recommend returning generic error messages or disabling detailed validation error output in production, and consider using error masking or logging detailed errors server-side only."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Unknown"
        ],
        "potential_categories": [
          "Unknown"
        ]
      },
      "comparison": {
        "total_categories": [
          "Unknown"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Unknown"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Unknown"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Unknown"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}