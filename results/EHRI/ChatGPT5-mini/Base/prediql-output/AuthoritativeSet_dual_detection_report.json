{
  "report_timestamp": "2025-10-03T01:15:06.122449",
  "api_url": "https://portal.ehri-project.eu/api/graphql",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.0,
    "simple_detections": 1,
    "llm_detections": 2,
    "consensus_breakdown": {
      "no_vulnerabilities": 8,
      "both_detected": 1,
      "llm_only": 1
    },
    "detection_ratio": 2.0,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 0,
      "llm_potential_detections": 2,
      "potential_consensus_breakdown": {
        "no_potential": 8,
        "llm_potential_only": 2
      },
      "potential_detection_ratio": Infinity
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-02T23:32:36.187923",
      "node_name": "AuthoritativeSet_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "AuthoritativeSet": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-02T23:32:54.952599",
      "node_name": "AuthoritativeSet_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "AuthoritativeSet": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-02T23:33:08.575910",
      "node_name": "AuthoritativeSet_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "AuthoritativeSet": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-02T23:33:23.922444",
      "node_name": "AuthoritativeSet_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "AuthoritativeSet": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-02T23:33:51.146578",
      "node_name": "AuthoritativeSet_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "AuthoritativeSet": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-02T23:34:04.973289",
      "node_name": "AuthoritativeSet_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "AuthoritativeSet": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:14:27.599566",
      "node_name": "AuthoritativeSet_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:14:37.146729",
      "node_name": "AuthoritativeSet_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:14:49.050315",
      "node_name": "AuthoritativeSet_response_10",
      "response_status": 200,
      "response_body": {
        "data": {
          "AuthoritativeSet": null,
          "__schema": {
            "types": [
              {
                "name": "AccessPoint"
              },
              {
                "name": "AccessPointType"
              },
              {
                "name": "Address"
              },
              {
                "name": "Annotatable"
              },
              {
                "name": "Annotation"
              },
              {
                "name": "AnnotationEdge"
              },
              {
                "name": "AuthoritativeSet"
              },
              {
                "name": "AuthoritativeSetEdge"
              },
              {
                "name": "BigDecimal"
              },
              {
                "name": "Boolean"
              },
              {
                "name": "Country"
              },
              {
                "name": "CountryEdge"
              },
              {
                "name": "Cursor"
              },
              {
                "name": "CvocConcept"
              },
              {
                "name": "CvocConceptDescription"
              },
              {
                "name": "CvocConceptEdge"
              },
              {
                "name": "CvocVocabulary"
              },
              {
                "name": "CvocVocabularyEdge"
              },
              {
                "name": "DatePeriod"
              },
              {
                "name": "Described"
              },
              {
                "name": "Description"
              },
              {
                "name": "DocumentaryUnit"
              },
              {
                "name": "DocumentaryUnitDescription"
              },
              {
                "name": "DocumentaryUnitEdge"
              },
              {
                "name": "Entity"
              },
              {
                "name": "HistoricalAgent"
              },
              {
                "name": "HistoricalAgentDescription"
              },
              {
                "name": "HistoricalAgentEdge"
              },
              {
                "name": "ID"
              },
              {
                "name": "Int"
              },
              {
                "name": "Link"
              },
              {
                "name": "LinkEdge"
              },
              {
                "name": "LinkType"
              },
              {
                "name": "Linkable"
              },
              {
                "name": "Relationship"
              },
              {
                "name": "Repository"
              },
              {
                "name": "RepositoryDescription"
              },
              {
                "name": "RepositoryEdge"
              },
              {
                "name": "Root"
              },
              {
                "name": "String"
              },
              {
                "name": "SystemEvent"
              },
              {
                "name": "Temporal"
              },
              {
                "name": "TemporalDescription"
              },
              {
                "name": "__Directive"
              },
              {
                "name": "__DirectiveLocation"
              },
              {
                "name": "__EnumValue"
              },
              {
                "name": "__Field"
              },
              {
                "name": "__InputValue"
              },
              {
                "name": "__Schema"
              },
              {
                "name": "__Type"
              },
              {
                "name": "__TypeKind"
              },
              {
                "name": "annotations"
              },
              {
                "name": "authoritativeSets"
              },
              {
                "name": "concepts"
              },
              {
                "name": "countries"
              },
              {
                "name": "documentaryUnits"
              },
              {
                "name": "historicalAgents"
              },
              {
                "name": "links"
              },
              {
                "name": "pageInfoAnnotation"
              },
              {
                "name": "pageInfoAuthoritativeSet"
              },
              {
                "name": "pageInfoCountry"
              },
              {
                "name": "pageInfoCvocConcept"
              },
              {
                "name": "pageInfoCvocVocabulary"
              },
              {
                "name": "pageInfoDocumentaryUnit"
              },
              {
                "name": "pageInfoHistoricalAgent"
              },
              {
                "name": "pageInfoLink"
              },
              {
                "name": "pageInfoRepository"
              },
              {
                "name": "repositories"
              },
              {
                "name": "vocabularies"
              }
            ]
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Introspection Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "GraphQL introspection enabled - potential information disclosure",
            "evidence": "Found __schema in response data - introspection queries are allowed"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: GraphQL Introspection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The GraphQL endpoint returned an __schema object and a types list in the response, indicating that GraphQL introspection is enabled and accessible. This exposes the API schema (type names, fields, and built-in introspection types) to unauthenticated callers, which facilitates attacker reconnaissance and makes it easier to craft targeted queries or discover sensitive fields/endpoints. Recommended mitigations: disable introspection in production or restrict it to authenticated/authorized users, apply query depth and complexity limits, and enforce least-privilege access controls on schema information.",
            "evidence": "Response body contains an \"__schema\" object with a \"types\" array listing type names (including introspection types like \"__Schema\", \"__Type\", \"__Field\", \"__InputValue\", \"__TypeKind\").",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "GraphQL Introspection",
              "severity": "MEDIUM",
              "confidence": 0.95,
              "evidence": "Response body contains an \"__schema\" object with a \"types\" array listing type names (including introspection types like \"__Schema\", \"__Type\", \"__Field\", \"__InputValue\", \"__TypeKind\").",
              "explanation": "The GraphQL endpoint returned an __schema object and a types list in the response, indicating that GraphQL introspection is enabled and accessible. This exposes the API schema (type names, fields, and built-in introspection types) to unauthenticated callers, which facilitates attacker reconnaissance and makes it easier to craft targeted queries or discover sensitive fields/endpoints. Recommended mitigations: disable introspection in production or restrict it to authenticated/authorized users, apply query depth and complexity limits, and enforce least-privilege access controls on schema information."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-03T01:15:06.117812",
      "node_name": "AuthoritativeSet_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (FieldUndefined@[AuthoritativeSet/nam]) : Field 'nam' in type 'AuthoritativeSet' is undefined",
            "locations": [
              {
                "line": 5,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[AuthoritativeSet/descrption]) : Field 'descrption' in type 'AuthoritativeSet' is undefined",
            "locations": [
              {
                "line": 6,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: field_suggestions",
            "detection": "potential",
            "category": "Unknown",
            "description": "The GraphQL response exposes internal schema details by returning type and field-level validation messages. The errors explicitly reference the type 'AuthoritativeSet' and the attempted field names ('nam' and 'descrption'), confirming that the server checks and reports on field names. Although the response does not provide corrected suggestions, this behavior discloses schema structure and enables an attacker to enumerate or probe valid fields and types. No signs of SQLi, XSS, SSRF, path/OS command injection, or sensitive data leakage were found in this response, but the schema disclosure risk can facilitate further targeted attacks.",
            "evidence": "errors: \"Validation error (FieldUndefined@[AuthoritativeSet/nam]) : Field 'nam' in type 'AuthoritativeSet' is undefined\"; \"Validation error (FieldUndefined@[AuthoritativeSet/descrption]) : Field 'descrption' in type 'AuthoritativeSet' is undefined\"",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "field_suggestions",
              "severity": "MEDIUM",
              "confidence": 0.8,
              "evidence": "errors: \"Validation error (FieldUndefined@[AuthoritativeSet/nam]) : Field 'nam' in type 'AuthoritativeSet' is undefined\"; \"Validation error (FieldUndefined@[AuthoritativeSet/descrption]) : Field 'descrption' in type 'AuthoritativeSet' is undefined\"",
              "explanation": "The GraphQL response exposes internal schema details by returning type and field-level validation messages. The errors explicitly reference the type 'AuthoritativeSet' and the attempted field names ('nam' and 'descrption'), confirming that the server checks and reports on field names. Although the response does not provide corrected suggestions, this behavior discloses schema structure and enables an attacker to enumerate or probe valid fields and types. No signs of SQLi, XSS, SSRF, path/OS command injection, or sensitive data leakage were found in this response, but the schema disclosure risk can facilitate further targeted attacks."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Unknown"
        ],
        "potential_categories": [
          "Unknown"
        ]
      },
      "comparison": {
        "total_categories": [
          "Unknown"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Unknown"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Unknown"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Unknown"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}