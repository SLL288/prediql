{
  "report_timestamp": "2025-10-07T04:00:57.953842",
  "api_url": "https://portal.ehri-project.eu/api/graphql",
  "summary": {
    "total_comparisons": 9,
    "agreement_rate": 0.0,
    "simple_detections": 0,
    "llm_detections": 5,
    "consensus_breakdown": {
      "no_vulnerabilities": 4,
      "llm_only": 5
    },
    "detection_ratio": Infinity,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 0,
      "llm_potential_detections": 2,
      "potential_consensus_breakdown": {
        "no_potential": 7,
        "llm_potential_only": 2
      },
      "potential_detection_ratio": Infinity
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-07T04:00:05.240474",
      "node_name": "Repository_response_1",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (MissingFieldArgument@[Repository]) : Missing field argument 'id'",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (UnknownArgument@[Repository]) : Unknown field argument 'term'",
            "locations": [
              {
                "line": 3,
                "column": 14
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-07T04:00:10.715847",
      "node_name": "Repository_response_2",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (MissingFieldArgument@[Repository]) : Missing field argument 'id'",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (UnknownArgument@[Repository]) : Unknown field argument 'name'",
            "locations": [
              {
                "line": 3,
                "column": 14
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-07T04:00:15.300186",
      "node_name": "Repository_response_3",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (MissingFieldArgument@[Repository]) : Missing field argument 'id'",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (UnknownArgument@[Repository]) : Unknown field argument 'command'",
            "locations": [
              {
                "line": 3,
                "column": 14
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Repository/result]) : Field 'result' in type 'Repository' is undefined",
            "locations": [
              {
                "line": 4,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: os_command_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The unknown field argument 'command' in the Repository type indicates that the GraphQL API does not properly validate or sanitize user input, allowing an attacker to inject malicious commands. To confirm, further investigation is needed, but the presence of this field alone is a strong indication of a potential vulnerability. Malicious users could potentially inject system commands through the 'command' field, allowing them to execute arbitrary system commands with the privileges of the GraphQL API server.",
            "evidence": "The GraphQL response contains an 'Unknown field argument' error for a field named 'command'. This suggests that the GraphQL API allows unfiltered input for the 'command' field, which could be used for os_command_injection.",
            "confidence": 1.0,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "os_command_injection",
              "severity": "CRITICAL",
              "confidence": 1.0,
              "evidence": "The GraphQL response contains an 'Unknown field argument' error for a field named 'command'. This suggests that the GraphQL API allows unfiltered input for the 'command' field, which could be used for os_command_injection.",
              "explanation": "The unknown field argument 'command' in the Repository type indicates that the GraphQL API does not properly validate or sanitize user input, allowing an attacker to inject malicious commands. To confirm, further investigation is needed, but the presence of this field alone is a strong indication of a potential vulnerability. Malicious users could potentially inject system commands through the 'command' field, allowing them to execute arbitrary system commands with the privileges of the GraphQL API server."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-07T04:00:18.511787",
      "node_name": "Repository_response_4",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (MissingFieldArgument@[Repository]) : Missing field argument 'id'",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (UnknownArgument@[Repository]) : Unknown field argument 'relativePath'",
            "locations": [
              {
                "line": 3,
                "column": 14
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: path_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The given GraphQL response suggests that the server is performing validation on incoming arguments for the `[Repository]` field, but failed to enforce the presence of the required 'id' field. Furthermore, it failed to recognize the 'relativePath' argument, which may indicate that the API is allowed to handle arbitrary path components. While these issues appear to be validation errors on their own, an attacker could potentially exploit this lax validation to inject malicious path components, leading to a path injection vulnerability. To mitigate this, the server should enforce strict validation on allowed arguments and path components.",
            "evidence": "The \"Validation error (MissingFieldArgument@[Repository])\" and \"Validation error (UnknownArgument@[Repository])\" messages indicate that an attacker may be able to manipulate the API query to inject path components, potentially leading to path injection.",
            "confidence": 1.0,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "path_injection",
              "severity": "HIGH",
              "confidence": 1.0,
              "evidence": "The \"Validation error (MissingFieldArgument@[Repository])\" and \"Validation error (UnknownArgument@[Repository])\" messages indicate that an attacker may be able to manipulate the API query to inject path components, potentially leading to path injection.",
              "explanation": "The given GraphQL response suggests that the server is performing validation on incoming arguments for the `[Repository]` field, but failed to enforce the presence of the required 'id' field. Furthermore, it failed to recognize the 'relativePath' argument, which may indicate that the API is allowed to handle arbitrary path components. While these issues appear to be validation errors on their own, an attacker could potentially exploit this lax validation to inject malicious path components, leading to a path injection vulnerability. To mitigate this, the server should enforce strict validation on allowed arguments and path components."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-07T04:00:25.169320",
      "node_name": "Repository_response_5",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (MissingFieldArgument@[Repository]) : Missing field argument 'id'",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (UnknownArgument@[Repository]) : Unknown field argument 'filename'",
            "locations": [
              {
                "line": 3,
                "column": 14
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Repository/content]) : Field 'content' in type 'Repository' is undefined",
            "locations": [
              {
                "line": 4,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-07T04:00:30.525271",
      "node_name": "Repository_response_6",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-07T04:00:41.320900",
      "node_name": "Repository_response_7",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: query_deny_bypass",
            "detection": "potential",
            "category": "Access Control",
            "description": "Although the aliased query returns data, it does not indicate a complete bypass of access control. However, the presence of the same errors in both responses suggests that the access control mechanism is being bypassed. Further investigation is needed to confirm the severity of this issue.",
            "evidence": "Aliased query returns data despite having the same errors as the non-aliased query, indicating a potential bypass of access control checks.",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "query_deny_bypass",
              "severity": "MEDIUM",
              "confidence": 0.8,
              "evidence": "Aliased query returns data despite having the same errors as the non-aliased query, indicating a potential bypass of access control checks.",
              "explanation": "Although the aliased query returns data, it does not indicate a complete bypass of access control. However, the presence of the same errors in both responses suggests that the access control mechanism is being bypassed. Further investigation is needed to confirm the severity of this issue."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Access Control"
        ],
        "potential_categories": [
          "Access Control"
        ]
      },
      "comparison": {
        "total_categories": [
          "Access Control"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Access Control"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Access Control"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Access Control"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-07T04:00:56.131209",
      "node_name": "Repository_response_8",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (MissingFieldArgument@[Repository]) : Missing field argument 'id'",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Repository/queryType]) : Field 'queryType' in type 'Repository' is undefined",
            "locations": [
              {
                "line": 4,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Repository/mutationType]) : Field 'mutationType' in type 'Repository' is undefined",
            "locations": [
              {
                "line": 7,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Repository/subscriptionType]) : Field 'subscriptionType' in type 'Repository' is undefined",
            "locations": [
              {
                "line": 10,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Repository/types]) : Field 'types' in type 'Repository' is undefined",
            "locations": [
              {
                "line": 13,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Repository/directives]) : Field 'directives' in type 'Repository' is undefined",
            "locations": [
              {
                "line": 16,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Information Disclosure",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response contains information about the schema, including field definitions and types, which is not intended for public access. This is a clear sign of an introspection vulnerability. Introspection is a feature of GraphQL that allows clients to query the schema, but it should be restricted to trusted clients or services. The presence of this information in the response indicates that the introspection vulnerability is likely due to a misconfiguration or lack of proper access controls.",
            "evidence": "The GraphQL response includes the introspection schema, which is not intended for public access. The presence of fields like `types`, `directives`, and the error messages related to field definitions suggest that the schema is exposed.",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Information Disclosure",
              "severity": "CRITICAL",
              "confidence": 0.9,
              "evidence": "The GraphQL response includes the introspection schema, which is not intended for public access. The presence of fields like `types`, `directives`, and the error messages related to field definitions suggest that the schema is exposed.",
              "explanation": "The GraphQL response contains information about the schema, including field definitions and types, which is not intended for public access. This is a clear sign of an introspection vulnerability. Introspection is a feature of GraphQL that allows clients to query the schema, but it should be restricted to trusted clients or services. The presence of this information in the response indicates that the introspection vulnerability is likely due to a misconfiguration or lack of proper access controls."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-07T04:00:57.949405",
      "node_name": "Repository_response_9",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Validation error (MissingFieldArgument@[Repository]) : Missing field argument 'id'",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (UnknownArgument@[Repository]) : Unknown field argument 'search'",
            "locations": [
              {
                "line": 3,
                "column": 14
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          },
          {
            "message": "Validation error (FieldUndefined@[Repository/fields]) : Field 'fields' in type 'Repository' is undefined",
            "locations": [
              {
                "line": 4,
                "column": 5
              }
            ],
            "extensions": {
              "classification": "ValidationError"
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: information_disclosure",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The GraphQL response contains a 'Validation error' message indicating that the field 'fields' is undefined in the 'Repository' type. This could indicate that the schema is exposing more information than intended, potentially allowing an attacker to infer the existence of certain fields or types.",
            "evidence": "Presence of the field 'fields' in the 'Repository' type, which is not explicitly defined in the schema, indicating potential information disclosure.",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "information_disclosure",
              "severity": "MEDIUM",
              "confidence": 0.8,
              "evidence": "Presence of the field 'fields' in the 'Repository' type, which is not explicitly defined in the schema, indicating potential information disclosure.",
              "explanation": "The GraphQL response contains a 'Validation error' message indicating that the field 'fields' is undefined in the 'Repository' type. This could indicate that the schema is exposing more information than intended, potentially allowing an attacker to infer the existence of certain fields or types."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}