{
  "report_timestamp": "2025-10-08T13:40:39.511521",
  "api_url": "http://localhost:4000/graphql",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.2,
    "simple_detections": 3,
    "llm_detections": 10,
    "consensus_breakdown": {
      "llm_only": 7,
      "both_detected": 3
    },
    "detection_ratio": 3.3333333333333335,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 2,
      "llm_potential_detections": 2,
      "potential_consensus_breakdown": {
        "no_potential": 6,
        "simple_potential_only": 2,
        "llm_potential_only": 2
      },
      "potential_detection_ratio": 1.0
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-08T13:40:02.828782",
      "node_name": "createCurrency_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "createCurrency": {
            "id": "0224b333-0ead-4260-a4a8-d1b84b3a1cbb",
            "abbreviation": "1 OR TRUE",
            "symbol": "s",
            "rate": 1,
            "country": "USA"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: SQL Injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL response contains a field with a value that resembles a SQL injection payload. The presence of '1 OR TRUE' suggests that an attacker may be able to inject malicious SQL code into the database. This is a critical vulnerability that could lead to unauthorized data access, modification, or even complete database compromise.",
            "evidence": "The 'abbreviation' field contains the string '1 OR TRUE', which is a classic indicator of a SQL Injection attack.",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "SQL Injection",
              "severity": "CRITICAL",
              "confidence": 0.9,
              "evidence": "The 'abbreviation' field contains the string '1 OR TRUE', which is a classic indicator of a SQL Injection attack.",
              "explanation": "The GraphQL response contains a field with a value that resembles a SQL injection payload. The presence of '1 OR TRUE' suggests that an attacker may be able to inject malicious SQL code into the database. This is a critical vulnerability that could lead to unauthorized data access, modification, or even complete database compromise."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T13:40:06.474569",
      "node_name": "createCurrency_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "createCurrency": {
            "id": "8787113c-918e-41ea-9276-4506f0d13005",
            "abbreviation": "xss",
            "symbol": "<script>alert('xss')</script>",
            "rate": 1,
            "country": "USA"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Cross-Site Scripting (XSS) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "XSS injection vulnerability detected - malicious script patterns found in response",
            "evidence": "Response status: 200, XSS patterns detected in response data"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: xss_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The presence of the HTML script tag in the 'symbol' field indicates a clear XSS vulnerability. This could allow an attacker to inject malicious JavaScript code, potentially leading to cross-site scripting attacks.",
            "evidence": "The 'symbol' field of the 'createCurrency' object contains an HTML script tag '<script>alert('xss')</script>'.",
            "confidence": 1.0,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "xss_injection",
              "severity": "CRITICAL",
              "confidence": 1.0,
              "evidence": "The 'symbol' field of the 'createCurrency' object contains an HTML script tag '<script>alert('xss')</script>'.",
              "explanation": "The presence of the HTML script tag in the 'symbol' field indicates a clear XSS vulnerability. This could allow an attacker to inject malicious JavaScript code, potentially leading to cross-site scripting attacks."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-08T13:40:09.724067",
      "node_name": "createCurrency_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "createCurrency": {
            "id": "0f5fb6ac-5992-4fe4-95f9-e98214d95fb5",
            "abbreviation": "ssrf",
            "symbol": "http://example.com",
            "rate": 1,
            "country": "USA"
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Server-Side Request Forgery (SSRF) Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "SSRF injection vulnerability detected - internal network access patterns found",
            "evidence": "Response status: 200, SSRF keywords detected in response"
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: SSRF",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The presence of the \"http://example.com\" in the \"symbol\" field suggests that the server may be vulnerable to SSRF attacks. An attacker could potentially inject malicious external requests through this field, which could lead to unauthorized access to internal resources or data leaks. The confidence level is 80% because without further analysis, it's difficult to determine if the field is intended for such use or if it's a legitimate part of the API response.",
            "evidence": "The GraphQL response includes a \"symbol\" field with a value of \"http://example.com\", which could potentially lead to SSRF (Server-Side Request Forgery) if the client can manipulate this value.",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "SSRF",
              "severity": "HIGH",
              "confidence": 0.8,
              "evidence": "The GraphQL response includes a \"symbol\" field with a value of \"http://example.com\", which could potentially lead to SSRF (Server-Side Request Forgery) if the client can manipulate this value.",
              "explanation": "The presence of the \"http://example.com\" in the \"symbol\" field suggests that the server may be vulnerable to SSRF attacks. An attacker could potentially inject malicious external requests through this field, which could lead to unauthorized access to internal resources or data leaks. The confidence level is 80% because without further analysis, it's difficult to determine if the field is intended for such use or if it's a legitimate part of the API response."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [
          "Injection Attacks"
        ],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 1.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [
            "Injection Attacks"
          ],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "simple_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-08T13:40:15.147218",
      "node_name": "createCurrency_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "createCurrency": {
            "id": "c7548368-2521-4afb-b737-db8a211fa81a",
            "abbreviation": "oscpwn",
            "symbol": "echo 'pwned'",
            "rate": 1,
            "country": "USA"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: os_command_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL API response contains the field 'symbol' with the value 'echo 'pwned''. This is a clear indication of an os command injection vulnerability. An attacker could potentially exploit this by crafting a GraphQL query to execute system commands, potentially leading to unauthorized access or data modification. This issue is critical, as it allows an attacker to execute arbitrary system commands, potentially leading to data breaches or system compromise.",
            "evidence": "The GraphQL API response contains a field named 'symbol' with the value 'echo 'pwned''. This suggests that an attacker could inject arbitrary system commands, leading to an os command injection vulnerability.",
            "confidence": 1.0,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "os_command_injection",
              "severity": "CRITICAL",
              "confidence": 1.0,
              "evidence": "The GraphQL API response contains a field named 'symbol' with the value 'echo 'pwned''. This suggests that an attacker could inject arbitrary system commands, leading to an os command injection vulnerability.",
              "explanation": "The GraphQL API response contains the field 'symbol' with the value 'echo 'pwned''. This is a clear indication of an os command injection vulnerability. An attacker could potentially exploit this by crafting a GraphQL query to execute system commands, potentially leading to unauthorized access or data modification. This issue is critical, as it allows an attacker to execute arbitrary system commands, potentially leading to data breaches or system compromise."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T13:40:17.349838",
      "node_name": "createCurrency_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "createCurrency": {
            "id": "c1576e20-9cb4-4992-8201-5e96081ba3cc",
            "abbreviation": "pathpwn",
            "symbol": "../path",
            "rate": 1,
            "country": "USA"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Path Injection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The GraphQL response contains a potential path injection vulnerability in the \"symbol\" field of the \"createCurrency\" response. The usage of \"../path\" in the symbol suggests that an attacker could potentially inject malicious paths into the system. This could lead to unauthorized access to sensitive data or files. However, the severity is medium as the vulnerability would require the attacker to be able to manipulate the \"symbol\" field in the first place.",
            "evidence": "\"symbol\": \"../path\"",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Path Injection",
              "severity": "MEDIUM",
              "confidence": 0.9,
              "evidence": "\"symbol\": \"../path\"",
              "explanation": "The GraphQL response contains a potential path injection vulnerability in the \"symbol\" field of the \"createCurrency\" response. The usage of \"../path\" in the symbol suggests that an attacker could potentially inject malicious paths into the system. This could lead to unauthorized access to sensitive data or files. However, the severity is medium as the vulnerability would require the attacker to be able to manipulate the \"symbol\" field in the first place."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-08T13:40:18.523623",
      "node_name": "createCurrency_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "createCurrency": {
            "id": "8cedc5b7-6795-4229-91d4-aee92c8854b2",
            "abbreviation": "htmlpwn",
            "symbol": "<iframe src='https://example.com'></iframe>",
            "rate": 1,
            "country": "USA"
          }
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: html_injection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The GraphQL API response contains HTML code in the 'symbol' field, which is a clear indicator of HTML injection vulnerability. This vulnerability allows an attacker to inject malicious HTML code, potentially leading to Cross-Site Scripting (XSS) attacks. The 'symbol' field is likely not intended to be an HTML injection vector, and this finding warrants further investigation and remediation.",
            "evidence": "\"symbol\": \"<iframe src='https://example.com'></iframe>\"",
            "confidence": 1.0,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "html_injection",
              "severity": "CRITICAL",
              "confidence": 1.0,
              "evidence": "\"symbol\": \"<iframe src='https://example.com'></iframe>\"",
              "explanation": "The GraphQL API response contains HTML code in the 'symbol' field, which is a clear indicator of HTML injection vulnerability. This vulnerability allows an attacker to inject malicious HTML code, potentially leading to Cross-Site Scripting (XSS) attacks. The 'symbol' field is likely not intended to be an HTML injection vector, and this finding warrants further investigation and remediation."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T13:40:23.403369",
      "node_name": "createCurrency_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: query_deny_bypass",
            "detection": "vulnerable",
            "category": "Access Control",
            "description": "The aliased query 'createCurrency' is able to bypass the access control checks by using a different query alias. This indicates a potential critical vulnerability as access control mechanisms are bypassed.",
            "evidence": "The aliased query 'createCurrency' succeeded with a 200 status and data although the non-aliased query was blocked with a 400 status or errors, indicating possible access control bypass.",
            "confidence": 1.0,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "query_deny_bypass",
              "severity": "CRITICAL",
              "confidence": 1.0,
              "evidence": "The aliased query 'createCurrency' succeeded with a 200 status and data although the non-aliased query was blocked with a 400 status or errors, indicating possible access control bypass.",
              "explanation": "The aliased query 'createCurrency' is able to bypass the access control checks by using a different query alias. This indicates a potential critical vulnerability as access control mechanisms are bypassed."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Access Control"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Access Control"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Access Control"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T13:40:28.602457",
      "node_name": "createCurrency_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: query_deny_bypass",
            "detection": "vulnerable",
            "category": "Access Control",
            "description": "The non-aliased query for 's' is returning valid data, but the aliased query for 'createCurrency' is also returning valid data without indicating any errors. Although the operation is similar in both queries, the lack of error messages and the presence of data in the aliased response suggest a potential bypass. We are conservatively marking this as HIGH severity but require further analysis to confirm.",
            "evidence": "Non-aliased query returns 200 and aliased query returns a similar result without errors, indicating potential bypass.",
            "confidence": 0.8,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "query_deny_bypass",
              "severity": "HIGH",
              "confidence": 0.8,
              "evidence": "Non-aliased query returns 200 and aliased query returns a similar result without errors, indicating potential bypass.",
              "explanation": "The non-aliased query for 's' is returning valid data, but the aliased query for 'createCurrency' is also returning valid data without indicating any errors. Although the operation is similar in both queries, the lack of error messages and the presence of data in the aliased response suggest a potential bypass. We are conservatively marking this as HIGH severity but require further analysis to confirm."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Access Control"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Access Control"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Access Control"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T13:40:32.032655",
      "node_name": "createCurrency_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"createCurrency\" on type \"Query\". Did you mean \"getCurrency\"?",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED",
              "exception": {
                "stacktrace": [
                  "GraphQLError: Cannot query field \"createCurrency\" on type \"Query\". Did you mean \"getCurrency\"?",
                  "    at Object.Field (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/validation/rules/FieldsOnCorrectTypeRule.js:46:31)",
                  "    at Object.enter (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/language/visitor.js:323:29)",
                  "    at Object.enter (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/utilities/TypeInfo.js:370:25)",
                  "    at visit (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/language/visitor.js:243:26)",
                  "    at Object.validate (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/validation/validate.js:69:24)",
                  "    at validate (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:221:34)",
                  "    at Object.<anonymous> (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:118:42)",
                  "    at Generator.next (<anonymous>)",
                  "    at fulfilled (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:5:58)",
                  "    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"
                ]
              }
            }
          }
        ]
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Introspection",
            "detection": "vulnerable",
            "category": "Injection Attacks",
            "description": "The presence of the error message in the response body, indicating an invalid field, provides enough information to allow an attacker to gather data on the GraphQL API schema, increasing the risk of schema introspection-based attacks. Furthermore, the error message 'Did you mean \"getCurrency\"?' is a direct pointer to the available fields in the 'Query' type, thereby exposing the schema to potential exploitation.",
            "evidence": "The error message includes GraphQL schema information (Cannot query field \"createCurrency\" on type \"Query\") which can be used for schema introspection to potentially gather sensitive information or conduct attacks against the GraphQL API.",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Introspection",
              "severity": "CRITICAL",
              "confidence": 0.9,
              "evidence": "The error message includes GraphQL schema information (Cannot query field \"createCurrency\" on type \"Query\") which can be used for schema introspection to potentially gather sensitive information or conduct attacks against the GraphQL API.",
              "explanation": "The presence of the error message in the response body, indicating an invalid field, provides enough information to allow an attacker to gather data on the GraphQL API schema, increasing the risk of schema introspection-based attacks. Furthermore, the error message 'Did you mean \"getCurrency\"?' is a direct pointer to the available fields in the 'Query' type, thereby exposing the schema to potential exploitation."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks"
        ],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "llm_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T13:40:39.506795",
      "node_name": "createCurrency_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"createCurrency\" on type \"Query\". Did you mean \"getCurrency\"?",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED",
              "exception": {
                "stacktrace": [
                  "GraphQLError: Cannot query field \"createCurrency\" on type \"Query\". Did you mean \"getCurrency\"?",
                  "    at Object.Field (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/validation/rules/FieldsOnCorrectTypeRule.js:46:31)",
                  "    at Object.enter (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/language/visitor.js:323:29)",
                  "    at Object.enter (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/utilities/TypeInfo.js:370:25)",
                  "    at visit (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/language/visitor.js:243:26)",
                  "    at Object.validate (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/validation/validate.js:69:24)",
                  "    at validate (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:221:34)",
                  "    at Object.<anonymous> (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:118:42)",
                  "    at Generator.next (<anonymous>)",
                  "    at fulfilled (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:5:58)",
                  "    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"
                ]
              }
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: unknown",
            "detection": "potential",
            "category": "Unknown",
            "description": "Based on the provided GraphQL response, I found evidence of a potential **`field_suggestions`** vulnerability. Here's the analysis:\n\n**Vulnerability Details**\n\n* **is_vulnerable**: `true`\n* **vulnerability_type**: `field_suggestions`\n* **severity**: `MEDIUM` (a field suggestion indicates a potential schema exposure, but it's not a direct security risk)\n* **confidence**: `0.8` (based on the presence of a field suggestion error message, which is indicative of schema exposure)\n* **evidence**: \"Cannot query field \\\"createCurrency\\\" on type \\\"Query\\\". Did you mean \\\"getCurrency\\\"?\" (the error message suggests that the API has a suggestion for a field that is not directly queried)\n* **explanation**: \"The error message contains a suggestion for a field (`getCurrency`) that is not part of the original query (`createCurrency`). This may indicate that the API has more fields available than it's advertising, which could be a sign of a schema exposure vulnerability.\"\n\n**Rationale**\n\nThe presence of a field suggestion error message in the response body indicates that the API is providing information about fields that are not directly accessed by the query. This could be a sign that the API has more fields available than it's advertising, which could be a potential security risk. While this is not a direct security risk, it's a potential indicator of a larger issue with the API's schema exposure.\n\n**Recommendation**\n\nConsider revising the API's schema to prevent field suggestion vulnerabilities. This can be done by ensuring that the API only provides information about fields that are directly queried or by implementing rate limiting or other security measures to prevent excessive querying of the API.\n\n**Conclusion**\n\nBased on the provided GraphQL response, I found evidence of a potential **`field_suggestions`** vulnerability. While this is not a direct security risk, it's a potential indicator of a larger issue with the API's schema exposure. I recommend further investigation and potential revisions to the API's schema to prevent such vulnerabilities.",
            "evidence": "Found vulnerability indicators in response",
            "confidence": 0.3,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "unknown",
              "severity": "MEDIUM",
              "confidence": 0.3,
              "evidence": "Found vulnerability indicators in response",
              "explanation": "Based on the provided GraphQL response, I found evidence of a potential **`field_suggestions`** vulnerability. Here's the analysis:\n\n**Vulnerability Details**\n\n* **is_vulnerable**: `true`\n* **vulnerability_type**: `field_suggestions`\n* **severity**: `MEDIUM` (a field suggestion indicates a potential schema exposure, but it's not a direct security risk)\n* **confidence**: `0.8` (based on the presence of a field suggestion error message, which is indicative of schema exposure)\n* **evidence**: \"Cannot query field \\\"createCurrency\\\" on type \\\"Query\\\". Did you mean \\\"getCurrency\\\"?\" (the error message suggests that the API has a suggestion for a field that is not directly queried)\n* **explanation**: \"The error message contains a suggestion for a field (`getCurrency`) that is not part of the original query (`createCurrency`). This may indicate that the API has more fields available than it's advertising, which could be a sign of a schema exposure vulnerability.\"\n\n**Rationale**\n\nThe presence of a field suggestion error message in the response body indicates that the API is providing information about fields that are not directly accessed by the query. This could be a sign that the API has more fields available than it's advertising, which could be a potential security risk. While this is not a direct security risk, it's a potential indicator of a larger issue with the API's schema exposure.\n\n**Recommendation**\n\nConsider revising the API's schema to prevent field suggestion vulnerabilities. This can be done by ensuring that the API only provides information about fields that are directly queried or by implementing rate limiting or other security measures to prevent excessive querying of the API.\n\n**Conclusion**\n\nBased on the provided GraphQL response, I found evidence of a potential **`field_suggestions`** vulnerability. While this is not a direct security risk, it's a potential indicator of a larger issue with the API's schema exposure. I recommend further investigation and potential revisions to the API's schema to prevent such vulnerabilities."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Unknown"
        ],
        "potential_categories": [
          "Unknown"
        ]
      },
      "comparison": {
        "total_categories": [
          "Unknown",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Unknown"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Unknown"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Unknown"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}