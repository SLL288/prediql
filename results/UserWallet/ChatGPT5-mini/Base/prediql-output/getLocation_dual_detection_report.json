{
  "report_timestamp": "2025-10-08T14:01:11.869904",
  "api_url": "http://localhost:4000/graphql",
  "summary": {
    "total_comparisons": 10,
    "agreement_rate": 0.0,
    "simple_detections": 2,
    "llm_detections": 2,
    "consensus_breakdown": {
      "no_vulnerabilities": 8,
      "both_detected": 2
    },
    "detection_ratio": 1.0,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 0,
      "llm_potential_detections": 2,
      "potential_consensus_breakdown": {
        "no_potential": 8,
        "llm_potential_only": 2
      },
      "potential_detection_ratio": Infinity
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-08T13:59:38.021203",
      "node_name": "getLocation_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "getLocation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T13:59:50.416157",
      "node_name": "getLocation_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "getLocation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T14:00:00.239528",
      "node_name": "getLocation_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "getLocation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T14:00:11.555373",
      "node_name": "getLocation_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "getLocation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T14:00:21.075362",
      "node_name": "getLocation_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "getLocation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T14:00:35.658580",
      "node_name": "getLocation_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "getLocation": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T14:00:42.079180",
      "node_name": "getLocation_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T14:00:51.498957",
      "node_name": "getLocation_response_9",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-08T14:01:02.964993",
      "node_name": "getLocation_response_10",
      "response_status": 200,
      "response_body": {
        "data": {
          "getLocation": null,
          "__schema": {
            "types": [
              {
                "name": "Query",
                "fields": [
                  {
                    "name": "getUser"
                  },
                  {
                    "name": "getTransaction"
                  },
                  {
                    "name": "getLocation"
                  },
                  {
                    "name": "getCurrency"
                  },
                  {
                    "name": "getWallet"
                  },
                  {
                    "name": "getUsers"
                  },
                  {
                    "name": "getWallets"
                  },
                  {
                    "name": "getTransactions"
                  },
                  {
                    "name": "getLocations"
                  },
                  {
                    "name": "getCurrencies"
                  },
                  {
                    "name": "getCurrentRate"
                  }
                ]
              },
              {
                "name": "ID",
                "fields": null
              },
              {
                "name": "Float",
                "fields": null
              },
              {
                "name": "String",
                "fields": null
              },
              {
                "name": "Mutation",
                "fields": [
                  {
                    "name": "createUser"
                  },
                  {
                    "name": "createTransaction"
                  },
                  {
                    "name": "createLocation"
                  },
                  {
                    "name": "createCurrency"
                  },
                  {
                    "name": "createWallet"
                  },
                  {
                    "name": "deleteUser"
                  },
                  {
                    "name": "deleteTransaction"
                  },
                  {
                    "name": "deleteLocation"
                  },
                  {
                    "name": "deleteCurrency"
                  },
                  {
                    "name": "deleteWallet"
                  },
                  {
                    "name": "updateUser"
                  },
                  {
                    "name": "updateTransaction"
                  },
                  {
                    "name": "updateLocation"
                  },
                  {
                    "name": "updateCurrency"
                  },
                  {
                    "name": "updateWallet"
                  }
                ]
              },
              {
                "name": "User",
                "fields": [
                  {
                    "name": "id"
                  },
                  {
                    "name": "firstName"
                  },
                  {
                    "name": "lastName"
                  },
                  {
                    "name": "description"
                  },
                  {
                    "name": "wallets"
                  },
                  {
                    "name": "friends"
                  }
                ]
              },
              {
                "name": "Wallet",
                "fields": [
                  {
                    "name": "id"
                  },
                  {
                    "name": "name"
                  },
                  {
                    "name": "currency"
                  },
                  {
                    "name": "transactions"
                  },
                  {
                    "name": "user"
                  },
                  {
                    "name": "balance"
                  }
                ]
              },
              {
                "name": "Transaction",
                "fields": [
                  {
                    "name": "id"
                  },
                  {
                    "name": "amount"
                  },
                  {
                    "name": "rate"
                  },
                  {
                    "name": "payer"
                  },
                  {
                    "name": "wallet"
                  },
                  {
                    "name": "description"
                  },
                  {
                    "name": "location"
                  },
                  {
                    "name": "timestamp"
                  }
                ]
              },
              {
                "name": "Currency",
                "fields": [
                  {
                    "name": "id"
                  },
                  {
                    "name": "abbreviation"
                  },
                  {
                    "name": "symbol"
                  },
                  {
                    "name": "rate"
                  },
                  {
                    "name": "country"
                  }
                ]
              },
              {
                "name": "Location",
                "fields": [
                  {
                    "name": "id"
                  },
                  {
                    "name": "lat"
                  },
                  {
                    "name": "lng"
                  },
                  {
                    "name": "name"
                  }
                ]
              },
              {
                "name": "Boolean",
                "fields": null
              },
              {
                "name": "__Schema",
                "fields": [
                  {
                    "name": "description"
                  },
                  {
                    "name": "types"
                  },
                  {
                    "name": "queryType"
                  },
                  {
                    "name": "mutationType"
                  },
                  {
                    "name": "subscriptionType"
                  },
                  {
                    "name": "directives"
                  }
                ]
              },
              {
                "name": "__Type",
                "fields": [
                  {
                    "name": "kind"
                  },
                  {
                    "name": "name"
                  },
                  {
                    "name": "description"
                  },
                  {
                    "name": "specifiedByUrl"
                  },
                  {
                    "name": "fields"
                  },
                  {
                    "name": "interfaces"
                  },
                  {
                    "name": "possibleTypes"
                  },
                  {
                    "name": "enumValues"
                  },
                  {
                    "name": "inputFields"
                  },
                  {
                    "name": "ofType"
                  }
                ]
              },
              {
                "name": "__TypeKind",
                "fields": null
              },
              {
                "name": "__Field",
                "fields": [
                  {
                    "name": "name"
                  },
                  {
                    "name": "description"
                  },
                  {
                    "name": "args"
                  },
                  {
                    "name": "type"
                  },
                  {
                    "name": "isDeprecated"
                  },
                  {
                    "name": "deprecationReason"
                  }
                ]
              },
              {
                "name": "__InputValue",
                "fields": [
                  {
                    "name": "name"
                  },
                  {
                    "name": "description"
                  },
                  {
                    "name": "type"
                  },
                  {
                    "name": "defaultValue"
                  }
                ]
              },
              {
                "name": "__EnumValue",
                "fields": [
                  {
                    "name": "name"
                  },
                  {
                    "name": "description"
                  },
                  {
                    "name": "isDeprecated"
                  },
                  {
                    "name": "deprecationReason"
                  }
                ]
              },
              {
                "name": "__Directive",
                "fields": [
                  {
                    "name": "name"
                  },
                  {
                    "name": "description"
                  },
                  {
                    "name": "isRepeatable"
                  },
                  {
                    "name": "locations"
                  },
                  {
                    "name": "args"
                  }
                ]
              },
              {
                "name": "__DirectiveLocation",
                "fields": null
              }
            ]
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Introspection Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "GraphQL introspection enabled - potential information disclosure",
            "evidence": "Found __schema in response data - introspection queries are allowed"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: Introspection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The response contains a __schema object with a full list of types, queries, mutations and fields (e.g., Query, Mutation, User, Wallet, Transaction, Location, Currency). This is direct proof that GraphQL introspection is enabled and returns schema metadata. Exposed schema information is an information disclosure risk: it makes it easier for an attacker to map the API surface, discover available operations and field names (including potential sensitive fields), and craft targeted queries or exploitation attempts (authorization bypasses, injection attempts, etc.). Mitigation: disable introspection in production or restrict it to authenticated/authorized users, and apply least-privilege access controls and schema-level field protections.",
            "evidence": "\"__schema\": { \"types\": [ { \"name\": \"Query\", \"fields\": [ { \"name\": \"getUser\" }, ... ] }, { \"name\": \"Mutation\", \"fields\": [ { \"name\": \"createUser\" }, ... ] }, ... ] }",
            "confidence": 1.0,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "Introspection",
              "severity": "MEDIUM",
              "confidence": 1.0,
              "evidence": "\"__schema\": { \"types\": [ { \"name\": \"Query\", \"fields\": [ { \"name\": \"getUser\" }, ... ] }, { \"name\": \"Mutation\", \"fields\": [ { \"name\": \"createUser\" }, ... ] }, ... ] }",
              "explanation": "The response contains a __schema object with a full list of types, queries, mutations and fields (e.g., Query, Mutation, User, Wallet, Transaction, Location, Currency). This is direct proof that GraphQL introspection is enabled and returns schema metadata. Exposed schema information is an information disclosure risk: it makes it easier for an attacker to map the API surface, discover available operations and field names (including potential sensitive fields), and craft targeted queries or exploitation attempts (authorization bypasses, injection attempts, etc.). Mitigation: disable introspection in production or restrict it to authenticated/authorized users, and apply least-privilege access controls and schema-level field protections."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-08T14:01:11.867300",
      "node_name": "getLocation_response_11",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Cannot query field \"nam\" on type \"Location\". Did you mean \"name\" or \"lat\"?",
            "locations": [
              {
                "line": 5,
                "column": 5
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED",
              "exception": {
                "stacktrace": [
                  "GraphQLError: Cannot query field \"nam\" on type \"Location\". Did you mean \"name\" or \"lat\"?",
                  "    at Object.Field (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/validation/rules/FieldsOnCorrectTypeRule.js:46:31)",
                  "    at Object.enter (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/language/visitor.js:323:29)",
                  "    at Object.enter (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/utilities/TypeInfo.js:370:25)",
                  "    at visit (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/language/visitor.js:243:26)",
                  "    at Object.validate (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/validation/validate.js:69:24)",
                  "    at validate (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:221:34)",
                  "    at Object.<anonymous> (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:118:42)",
                  "    at Generator.next (<anonymous>)",
                  "    at fulfilled (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:5:58)",
                  "    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"
                ]
              }
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: field_suggestions",
            "detection": "potential",
            "category": "Unknown",
            "description": "The GraphQL error response explicitly suggests valid field names ('name', 'lat') when the client queried an invalid field ('nam'). This behavior discloses schema details and aids an attacker in enumerating types and fields (schema reconnaissance). The response also includes an exception stacktrace, further increasing information leakage. While this does not directly allow data modification, it facilitates targeted attacks and should be treated as an information disclosure risk. Mitigation: disable or sanitize developer-oriented error messages in production (remove helpful field suggestions and stacktraces), configure GraphQL server to return minimal errors, and use logging for internal diagnostics only.",
            "evidence": "Error message: \"Cannot query field \\\"nam\\\" on type \\\"Location\\\". Did you mean \\\"name\\\" or \\\"lat\\\"?\" (extensions.exception.stacktrace present)",
            "confidence": 0.9,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "field_suggestions",
              "severity": "MEDIUM",
              "confidence": 0.9,
              "evidence": "Error message: \"Cannot query field \\\"nam\\\" on type \\\"Location\\\". Did you mean \\\"name\\\" or \\\"lat\\\"?\" (extensions.exception.stacktrace present)",
              "explanation": "The GraphQL error response explicitly suggests valid field names ('name', 'lat') when the client queried an invalid field ('nam'). This behavior discloses schema details and aids an attacker in enumerating types and fields (schema reconnaissance). The response also includes an exception stacktrace, further increasing information leakage. While this does not directly allow data modification, it facilitates targeted attacks and should be treated as an information disclosure risk. Mitigation: disable or sanitize developer-oriented error messages in production (remove helpful field suggestions and stacktraces), configure GraphQL server to return minimal errors, and use logging for internal diagnostics only."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Unknown"
        ],
        "potential_categories": [
          "Unknown"
        ]
      },
      "comparison": {
        "total_categories": [
          "Unknown",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Unknown"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Unknown"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Unknown"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}