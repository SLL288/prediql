{
  "report_timestamp": "2025-10-09T19:30:31.198282",
  "api_url": "http://localhost:4000/graphql",
  "summary": {
    "total_comparisons": 9,
    "agreement_rate": 0.0,
    "simple_detections": 3,
    "llm_detections": 2,
    "consensus_breakdown": {
      "no_vulnerabilities": 6,
      "simple_only": 1,
      "both_detected": 2
    },
    "detection_ratio": 0.6666666666666666,
    "potential_analysis": {
      "potential_agreement_rate": 0.0,
      "simple_potential_detections": 0,
      "llm_potential_detections": 2,
      "potential_consensus_breakdown": {
        "no_potential": 7,
        "llm_potential_only": 2
      },
      "potential_detection_ratio": Infinity
    }
  },
  "detailed_comparisons": [
    {
      "timestamp": "2025-10-09T19:27:41.587625",
      "node_name": "getCurrentRate_response_2",
      "response_status": 200,
      "response_body": {
        "data": {
          "getCurrentRate": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-09T19:28:00.602064",
      "node_name": "getCurrentRate_response_3",
      "response_status": 200,
      "response_body": {
        "data": {
          "getCurrentRate": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-09T19:28:14.845858",
      "node_name": "getCurrentRate_response_4",
      "response_status": 200,
      "response_body": {
        "data": {
          "getCurrentRate": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-09T19:28:39.955414",
      "node_name": "getCurrentRate_response_5",
      "response_status": 200,
      "response_body": {
        "data": {
          "getCurrentRate": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-09T19:29:00.970159",
      "node_name": "getCurrentRate_response_6",
      "response_status": 200,
      "response_body": {
        "data": {
          "getCurrentRate": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-09T19:29:30.089694",
      "node_name": "getCurrentRate_response_7",
      "response_status": 200,
      "response_body": {
        "data": {
          "getCurrentRate": null
        }
      },
      "simple_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [],
        "common_categories": [],
        "simple_unique_categories": [],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "no_vulnerabilities",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-09T19:29:51.231397",
      "node_name": "getCurrentRate_response_8",
      "response_status": null,
      "response_body": null,
      "simple_detector": {
        "results": [
          {
            "detection_name": "Query Deny Bypass",
            "detection": "vulnerable",
            "category": "Access Control",
            "description": "Query deny bypass vulnerability confirmed - non-aliased query blocked but aliased query succeeded without errors",
            "evidence": "Non-aliased: 400, Aliased: 200, Aliased clean success: True"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Access Control"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [],
        "count": 0,
        "vulnerable_count": 0,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [],
        "potential_categories": []
      },
      "comparison": {
        "total_categories": [
          "Access Control"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Access Control"
        ],
        "llm_unique_categories": [],
        "agreement_score": 0.0,
        "consensus": "simple_only",
        "potential_analysis": {
          "total_potential_categories": [],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [],
          "potential_agreement_score": 0.0,
          "potential_consensus": "no_potential"
        }
      }
    },
    {
      "timestamp": "2025-10-09T19:30:12.816318",
      "node_name": "getCurrentRate_response_9",
      "response_status": 200,
      "response_body": {
        "data": {
          "getCurrentRate": null,
          "__schema": {
            "queryType": {
              "name": "Query"
            },
            "types": [
              {
                "name": "Query"
              },
              {
                "name": "ID"
              },
              {
                "name": "Float"
              },
              {
                "name": "String"
              },
              {
                "name": "Mutation"
              },
              {
                "name": "User"
              },
              {
                "name": "Wallet"
              },
              {
                "name": "Transaction"
              },
              {
                "name": "Currency"
              },
              {
                "name": "Location"
              },
              {
                "name": "Boolean"
              },
              {
                "name": "__Schema"
              },
              {
                "name": "__Type"
              },
              {
                "name": "__TypeKind"
              },
              {
                "name": "__Field"
              },
              {
                "name": "__InputValue"
              },
              {
                "name": "__EnumValue"
              },
              {
                "name": "__Directive"
              },
              {
                "name": "__DirectiveLocation"
              }
            ]
          }
        }
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Introspection Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "GraphQL introspection enabled - potential information disclosure",
            "evidence": "Found __schema in response data - introspection queries are allowed"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: GraphQL Introspection",
            "detection": "potential",
            "category": "Injection Attacks",
            "description": "The response contains an '__schema' object with a list of types (including User, Wallet, Transaction, Query, Mutation, etc.), which is the direct output of a GraphQL introspection query. This indicates the GraphQL introspection feature is enabled and accessible. Exposed schema information allows an attacker to enumerate available types, fields, queries and mutations and craft targeted queries to discover or exfiltrate data (especially given types like User/Wallet/Transaction). While introspection itself does not necessarily leak actual records, it significantly lowers the effort required to find endpoints and fields that may return sensitive data and can facilitate further attacks (authorization bypass, data harvesting, etc.).\n\nRecommended mitigations: disable or restrict introspection in production, require authentication/authorization to access schema information, implement query whitelisting, rate limiting and depth/complexity limits, and monitor for suspicious introspection activity.",
            "evidence": "\"__schema\": { \"types\": [ { \"name\": \"Query\" }, { \"name\": \"User\" }, { \"name\": \"Wallet\" }, { \"name\": \"Transaction\" }, ... ] }",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "GraphQL Introspection",
              "severity": "MEDIUM",
              "confidence": 0.95,
              "evidence": "\"__schema\": { \"types\": [ { \"name\": \"Query\" }, { \"name\": \"User\" }, { \"name\": \"Wallet\" }, { \"name\": \"Transaction\" }, ... ] }",
              "explanation": "The response contains an '__schema' object with a list of types (including User, Wallet, Transaction, Query, Mutation, etc.), which is the direct output of a GraphQL introspection query. This indicates the GraphQL introspection feature is enabled and accessible. Exposed schema information allows an attacker to enumerate available types, fields, queries and mutations and craft targeted queries to discover or exfiltrate data (especially given types like User/Wallet/Transaction). While introspection itself does not necessarily leak actual records, it significantly lowers the effort required to find endpoints and fields that may return sensitive data and can facilitate further attacks (authorization bypass, data harvesting, etc.).\n\nRecommended mitigations: disable or restrict introspection in production, require authentication/authorization to access schema information, implement query whitelisting, rate limiting and depth/complexity limits, and monitor for suspicious introspection activity."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Injection Attacks"
        ],
        "potential_categories": [
          "Injection Attacks"
        ]
      },
      "comparison": {
        "total_categories": [
          "Injection Attacks",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Injection Attacks"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Injection Attacks"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Injection Attacks"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    },
    {
      "timestamp": "2025-10-09T19:30:31.195912",
      "node_name": "getCurrentRate_response_10",
      "response_status": 400,
      "response_body": {
        "errors": [
          {
            "message": "Unknown argument \"mainCurrenySymbol\" on field \"Query.getCurrentRate\". Did you mean \"mainCurrencySymbol\" or \"foreignCurrencySymbol\"?",
            "locations": [
              {
                "line": 3,
                "column": 18
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED",
              "exception": {
                "stacktrace": [
                  "GraphQLError: Unknown argument \"mainCurrenySymbol\" on field \"Query.getCurrentRate\". Did you mean \"mainCurrencySymbol\" or \"foreignCurrencySymbol\"?",
                  "    at Object.Argument (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/validation/rules/KnownArgumentNamesRule.js:46:29)",
                  "    at Object.enter (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/language/visitor.js:323:29)",
                  "    at Object.enter (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/utilities/TypeInfo.js:370:25)",
                  "    at visit (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/language/visitor.js:243:26)",
                  "    at Object.validate (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/validation/validate.js:69:24)",
                  "    at validate (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:221:34)",
                  "    at Object.<anonymous> (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:118:42)",
                  "    at Generator.next (<anonymous>)",
                  "    at fulfilled (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:5:58)",
                  "    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"
                ]
              }
            }
          },
          {
            "message": "Field \"getCurrentRate\" argument \"mainCurrencySymbol\" of type \"String!\" is required, but it was not provided.",
            "locations": [
              {
                "line": 3,
                "column": 3
              }
            ],
            "extensions": {
              "code": "GRAPHQL_VALIDATION_FAILED",
              "exception": {
                "stacktrace": [
                  "GraphQLError: Field \"getCurrentRate\" argument \"mainCurrencySymbol\" of type \"String!\" is required, but it was not provided.",
                  "    at Object.leave (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/validation/rules/ProvidedRequiredArgumentsRule.js:62:33)",
                  "    at Object.leave (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/language/visitor.js:344:29)",
                  "    at Object.leave (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/utilities/TypeInfo.js:390:21)",
                  "    at visit (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/language/visitor.js:243:26)",
                  "    at Object.validate (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/graphql/validation/validate.js:69:24)",
                  "    at validate (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:221:34)",
                  "    at Object.<anonymous> (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:118:42)",
                  "    at Generator.next (<anonymous>)",
                  "    at fulfilled (/Users/sina/Documents/GraphQLer2022/test_server/node_modules/apollo-server-core/dist/requestPipeline.js:5:58)",
                  "    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"
                ]
              }
            }
          }
        ]
      },
      "simple_detector": {
        "results": [
          {
            "detection_name": "Field Suggestions Enabled",
            "detection": "vulnerable",
            "category": "Information Disclosure",
            "description": "Field suggestions enabled - potential information disclosure",
            "evidence": "Found \"did you mean\" in error message - field suggestions are enabled"
          }
        ],
        "count": 1,
        "vulnerable_count": 1,
        "potential_count": 0,
        "safe_count": 0,
        "categories": [
          "Information Disclosure"
        ],
        "potential_categories": []
      },
      "llm_detector": {
        "results": [
          {
            "detection_name": "LLM: field_suggestions",
            "detection": "potential",
            "category": "Unknown",
            "description": "The GraphQL error message returns explicit argument/field name suggestions (\"Did you mean 'mainCurrencySymbol' or 'foreignCurrencySymbol'?\"). This reveals internal schema details (valid argument names) to an unauthenticated client, enabling schema discovery and more targeted attacks or probing. To remediate, disable verbose validation suggestions in production (or sanitize error messages), and return generic validation errors without exposing field/argument names or schema hints.",
            "evidence": "\"Unknown argument \\\"mainCurrenySymbol\\\" on field \\\"Query.getCurrentRate\\\". Did you mean \\\"mainCurrencySymbol\\\" or \\\"foreignCurrencySymbol\\\"?\"",
            "confidence": 0.95,
            "llm_analysis": {
              "is_vulnerable": true,
              "vulnerability_type": "field_suggestions",
              "severity": "MEDIUM",
              "confidence": 0.95,
              "evidence": "\"Unknown argument \\\"mainCurrenySymbol\\\" on field \\\"Query.getCurrentRate\\\". Did you mean \\\"mainCurrencySymbol\\\" or \\\"foreignCurrencySymbol\\\"?\"",
              "explanation": "The GraphQL error message returns explicit argument/field name suggestions (\"Did you mean 'mainCurrencySymbol' or 'foreignCurrencySymbol'?\"). This reveals internal schema details (valid argument names) to an unauthenticated client, enabling schema discovery and more targeted attacks or probing. To remediate, disable verbose validation suggestions in production (or sanitize error messages), and return generic validation errors without exposing field/argument names or schema hints."
            }
          }
        ],
        "count": 1,
        "vulnerable_count": 0,
        "potential_count": 1,
        "safe_count": 0,
        "categories": [
          "Unknown"
        ],
        "potential_categories": [
          "Unknown"
        ]
      },
      "comparison": {
        "total_categories": [
          "Unknown",
          "Information Disclosure"
        ],
        "common_categories": [],
        "simple_unique_categories": [
          "Information Disclosure"
        ],
        "llm_unique_categories": [
          "Unknown"
        ],
        "agreement_score": 0.0,
        "consensus": "both_detected",
        "potential_analysis": {
          "total_potential_categories": [
            "Unknown"
          ],
          "common_potential_categories": [],
          "simple_unique_potential_categories": [],
          "llm_unique_potential_categories": [
            "Unknown"
          ],
          "potential_agreement_score": 0.0,
          "potential_consensus": "llm_potential_only"
        }
      }
    }
  ],
  "detector_analysis": {
    "simple_detector": {
      "description": "Rule-based detector using predefined patterns",
      "strengths": [
        "Fast execution",
        "Consistent results",
        "Low resource usage"
      ],
      "weaknesses": [
        "Limited to known patterns",
        "May miss novel attacks",
        "False negatives possible"
      ]
    },
    "llm_detector": {
      "description": "AI-powered detector using language model analysis",
      "strengths": [
        "Contextual understanding",
        "Novel attack detection",
        "Detailed analysis"
      ],
      "weaknesses": [
        "Slower execution",
        "Resource intensive",
        "Potential false positives"
      ]
    }
  }
}